!function(s){function a(e){s.when(s("#woograbexpress-buttons").remove()).then(function(){s("#btn-ok").hide().after(wp.template("woograbexpress-buttons")(function(e){var o={btn_right:{id:"save-settings",icon:"yes",label:n("buttons.Save Changes")}};return e||o}(e)))})}function r(e,o,r){"string"==typeof o&&(o=o.split("."));try{for(var a=e,n=0;n<o.length;n++)a=a[o[n]];return a}catch(e){return console.log("woograbexpressObject",e),r}}function n(e,o){return r(woograbexpress_backend.i18n,e,o)}function t(e,o){return r(woograbexpress_backend.i18n.errors,e,o)}!function(e){"use strict";var i,s,n,a,t,o,l,p,r;i=[],s=function(){},n={},a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],l=[],p={},r=function(){return s},t=e.console?function(n){var t;return n in console&&(t=console[n])&&(console[n]=function(){var e,o,r,a;for(e=i.slice.call(arguments,0),r=0,a=p[n].handlers.length;r<a;r++)s.apply.call(p[n].handlers[r],console,e);for(r=0,a=l.length;r<a;r++)o=[n],i.push.apply(o,e),s.apply.call(l[r],console,o);s.apply.call(t,console,e)}),console[n]||r}:r,function(){var e,o,r;for(e=0,o=a.length;e<o;e++)p[r=a[e]]={handlers:[]},t(r)}(),o=function(e,o){var r,a;if("[object Object]"===n.toString.call(e))for(r in e)a=e[r],"all"===r?l.push(a):r in p&&p[r].handlers.push(a);else"function"==typeof e?l.push(e):e in p&&p[e].handlers.push(o)},e.ConsoleListener={on:o}}(this);var l={params:{},origin_lat:"",origin_lng:"",origin_address:"",zoomLevel:16,apiKeyErrorCheckInterval:null,apiKeyError:"",editingAPIKey:!1,init:function(e){l.params=e,l.apiKeyError="",l.editingAPIKey=!1,ConsoleListener.on("error",function(e){-1!==e.toLowerCase().indexOf("google")&&(l.apiKeyError=e),s(".gm-err-message").length&&s(".gm-err-message").replaceWith('<p style="text-align:center">'+l.convertError(e)+"</p>")}),s('[data-link="api_key"]').each(function(){s(this).after(wp.template("woograbexpress-button")({href:"#",class:"woograbexpress-buttons--has-icon woograbexpress-api-key-button",text:'<span class="dashicons"></span>'}))}),s(document).off("focus",'[data-link="api_key"]'),s(document).on("focus",'[data-link="api_key"]',function(){s(this).prop("readonly")&&!s(this).hasClass("loading")&&s(this).data("value",s(this).val()).prop("readonly",!1)}),s(document).off("blur",'[data-link="api_key"]'),s(document).on("blur",'[data-link="api_key"]',function(){s(this).prop("readonly")||s(this).hasClass("editing")||s(this).data("value",void 0).prop("readonly",!0)}),s(document).off("input",'[data-link="api_key"]',l.handleApiKeyInput),s(document).on("input",'[data-link="api_key"]',l.handleApiKeyInput),s(document).off("click",".woograbexpress-api-key-button",l.editApiKey),s(document).on("click",".woograbexpress-api-key-button",l.editApiKey),s(document).off("click",".woograbexpress-field--origin"),s(document).on("click",".woograbexpress-field--origin",function(){s(this).prop("readonly")&&s(".woograbexpress-edit-location-picker").trigger("click")}),s(document).off("focus",'[data-link="location_picker"]',l.showLocationPicker),s(document).on("focus",'[data-link="location_picker"]',l.showLocationPicker),s(document).off("click","#woograbexpress-btn--map-cancel",l.hideLocationPicker),s(document).on("click","#woograbexpress-btn--map-cancel",l.hideLocationPicker),s(document).off("click","#woograbexpress-btn--map-apply",l.applyLocationPicker),s(document).on("click","#woograbexpress-btn--map-apply",l.applyLocationPicker),s(document).off("click","#woograbexpress-map-search-panel-toggle",l.toggleMapSearch),s(document).on("click","#woograbexpress-map-search-panel-toggle",l.toggleMapSearch)},validateAPIKeyBothSide:function(e){l.validateAPIKeyServerSide(e,l.validateAPIKeyBrowserSide)},validateAPIKeyBrowserSide:function(r){l.apiKeyError="",l.initMap(r.val(),function(){var e={latLng:new google.maps.LatLng(parseFloat(l.params.defaultLat),parseFloat(l.params.defaultLng))};(new google.maps.Geocoder).geocode(e,function(e,o){"ok"===o.toLowerCase()&&(console.log("validateAPIKeyBrowserSide",e),r.addClass("valid"),setTimeout(function(){r.removeClass("editing loading valid")},2e3))}),clearInterval(l.apiKeyErrorCheckInterval),l.apiKeyErrorCheckInterval=setInterval(function(){(r.hasClass("valid")||l.apiKeyError)&&clearInterval(l.apiKeyErrorCheckInterval),l.apiKeyError&&(l.showError(r,l.apiKeyError),r.prop("readonly",!1).removeClass("loading"))},300)})},validateAPIKeyServerSide:function(o,r){s.ajax({method:"POST",url:l.params.ajax_url,data:{action:"woograbexpress_validate_api_key_server",nonce:l.params.validate_api_key_nonce,key:o.val()}}).done(function(e){console.log("validateAPIKeyServerSide",e),"function"==typeof r?r(o):(o.addClass("valid"),setTimeout(function(){o.removeClass("editing loading valid")},2e3))}).fail(function(e){e.responseJSON&&e.responseJSON.data?l.showError(o,e.responseJSON.data):e.statusText?l.showError(o,e.statusText):l.showError(o,"Google Distance Matrix API error: Uknown"),o.prop("readonly",!1).removeClass("loading")})},showError:function(e,o){s('<div class="error notice woograbexpress-error-box"><p>'+l.convertError(o)+"</p></div>").hide().appendTo(e.closest("td")).slideDown()},removeError:function(e){e.closest("td").find(".woograbexpress-error-box").remove()},convertError:function(e){return e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>")},handleApiKeyInput:function(e){var o=s(e.currentTarget);o.val()===o.data("value")?o.removeClass("editing").next(".woograbexpress-edit-api-key").removeClass("editing"):o.addClass("editing").next(".woograbexpress-edit-api-key").addClass("editing"),l.removeError(o)},editApiKey:function(e){e.preventDefault();var o=s(this).blur().prev("input");o.hasClass("editing")&&!o.hasClass("loading")&&(o.prop("readonly",!0).addClass("loading"),"api_key"===o.attr("data-key")?l.validateAPIKeyServerSide(o):l.validateAPIKeyBrowserSide(o),l.removeError(o))},showLocationPicker:function(e){e.preventDefault(),s(this).blur(),l.apiKeyError="";var o=s("#woocommerce_woograbexpress_api_key_picker").val();if(l.isEditingAPIKey())return window.alert(t("finish_editing_api"));if(!o.length)return window.alert(t("api_key_picker_empty"));s(".modal-close-link").hide(),a({btn_left:{id:"map-cancel",label:n("buttons.Cancel"),icon:"undo"},btn_right:{id:"map-apply",label:n("buttons.Apply Changes"),icon:"editor-spellcheck"}}),s("#woograbexpress-field-group-wrap--location_picker").fadeIn().siblings().hide();var r=s("#woograbexpress-field-group-wrap--location_picker").find(".wc-settings-sub-title").first().addClass("woograbexpress-hidden");s(".wc-backbone-modal-header").find("h1").append("<span>"+r.text()+"</span>"),l.initMap(o,l.renderMap)},hideLocationPicker:function(e){e.preventDefault(),l.destroyMap(),s(".modal-close-link").show(),a(),s("#woograbexpress-field-group-wrap--location_picker").find(".wc-settings-sub-title").first().removeClass("woograbexpress-hidden"),s(".wc-backbone-modal-header").find("h1 span").remove(),s("#woograbexpress-field-group-wrap--location_picker").hide().siblings().not(".woograbexpress-hidden").fadeIn()},applyLocationPicker:function(e){e.preventDefault(),l.apiKeyError||(s("#woocommerce_woograbexpress_origin_lat").val(l.origin_lat),s("#woocommerce_woograbexpress_origin_lng").val(l.origin_lng),s("#woocommerce_woograbexpress_origin_address").val(l.origin_address)),l.hideLocationPicker(e)},toggleMapSearch:function(e){e.preventDefault(),s("#woograbexpress-map-search-panel").toggleClass("expanded")},initMap:function(e,o){l.destroyMap(),_.isEmpty(e)&&(e="InvalidKey"),s.getScript("https://maps.googleapis.com/maps/api/js?libraries=geometry,places&key="+e,o)},renderMap:function(){l.origin_lat=s("#woocommerce_woograbexpress_origin_lat").val(),l.origin_lng=s("#woocommerce_woograbexpress_origin_lng").val();var e={lat:_.isEmpty(l.origin_lat)?parseFloat(l.params.defaultLat):parseFloat(l.origin_lat),lng:_.isEmpty(l.origin_lng)?parseFloat(l.params.defaultLng):parseFloat(l.origin_lng)},r=new google.maps.Map(document.getElementById("woograbexpress-map-canvas"),{mapTypeId:"roadmap",center:e,zoom:l.zoomLevel,streetViewControl:!1,mapTypeControl:!1}),a=new google.maps.Marker({map:r,position:e,draggable:!0,icon:l.params.marker}),n=new google.maps.InfoWindow({maxWidth:350});_.isEmpty(l.origin_lat)||_.isEmpty(l.origin_lng)?(n.setContent(l.params.i18n.drag_marker),n.open(r,a)):l.setLatLng(a.position,a,r,n),google.maps.event.addListener(a,"dragstart",function(){n.close()}),google.maps.event.addListener(a,"dragend",function(e){l.setLatLng(e.latLng,a,r,n)}),s("#woograbexpress-map-wrap").prepend(wp.template("woograbexpress-map-search-panel")()),r.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById("woograbexpress-map-search-panel"));var t=new google.maps.places.SearchBox(document.getElementById("woograbexpress-map-search-input"));r.addListener("bounds_changed",function(){t.setBounds(r.getBounds())});var i=[];t.addListener("places_changed",function(){var e=t.getPlaces();if(0!==e.length){i.forEach(function(e){e.setMap(null)}),i=[];var o=new google.maps.LatLngBounds;e.forEach(function(e){e.geometry?(a=new google.maps.Marker({map:r,position:e.geometry.location,draggable:!0,icon:l.params.marker}),l.setLatLng(e.geometry.location,a,r,n),google.maps.event.addListener(a,"dragstart",function(){n.close()}),google.maps.event.addListener(a,"dragend",function(e){l.setLatLng(e.latLng,a,r,n)}),i.push(a),e.geometry.viewport?o.union(e.geometry.viewport):o.extend(e.geometry.location)):console.log("Returned place contains no geometry")}),r.fitBounds(o)}}),setTimeout(function(){s("#woograbexpress-map-search-panel").removeClass("woograbexpress-hidden")},500)},destroyMap:function(){window.google&&(window.google=void 0),s("#woograbexpress-map-canvas").empty(),s("#woograbexpress-map-search-panel").remove()},setLatLng:function(a,n,t,i){(new google.maps.Geocoder).geocode({latLng:a},function(e,o){if(o===google.maps.GeocoderStatus.OK&&e[0]){var r=[l.params.i18n.latitude+": "+a.lat().toString(),l.params.i18n.longitude+": "+a.lng().toString()];i.setContent(r.join("<br />")),i.open(t,n),n.addListener("click",function(){i.open(t,n)}),s("#woograbexpress-map-search-input").val(e[0].formatted_address),l.origin_lat=a.lat(),l.origin_lng=a.lng(),l.origin_address=e[0].formatted_address}}),t.setCenter(a)},isEditingAPIKey:function(){return 0<s('[data-link="api_key"].editing').length}},o={renderForm:function(){if(s("#woocommerce_woograbexpress_origin_type")&&s("#woocommerce_woograbexpress_origin_type").length){s(document).off("click","#woograbexpress-btn--save-settings",o.submitForm),s(document).on("click","#woograbexpress-btn--save-settings",o.submitForm),s(document).off("change","#woocommerce_woograbexpress_origin_type",o.toggleStoreOriginFields),s(document).on("change","#woocommerce_woograbexpress_origin_type",o.toggleStoreOriginFields),s("#woocommerce_woograbexpress_origin_type").trigger("change"),s(".wc-modal-shipping-method-settings table.form-table").each(function(){var e=s(this);e.find("tr").length||e.remove()}),s(".woograbexpress-field-group").each(function(){var e=s(this),o=e.attr("id").replace("woocommerce_woograbexpress_field_group_",""),r=e.next("p").detach(),a=e.nextAll("table.form-table").first().attr("id","woograbexpress-table--"+o).addClass("woograbexpress-table woograbexpress-table--"+o).detach();e.wrap('<div id="woograbexpress-field-group-wrap--'+o+'" class="woograbexpress-field-group-wrap stuffbox woograbexpress-field-group-wrap--'+o+'"></div>'),r.appendTo("#woograbexpress-field-group-wrap--"+o),a.appendTo("#woograbexpress-field-group-wrap--"+o),a&&a.length?e.hasClass("woograbexpress-field-group-hidden")&&s("#woograbexpress-field-group-wrap--"+o).addClass("woograbexpress-hidden"):s("#woograbexpress-field-group-wrap--"+o).remove()}),s(".woograbexpress-field").each(function(){var e=s(this),o=e.attr("data-unit");o&&(e.next(".woograbexpress-field-unit").remove(),e.after('<span class="woograbexpress-field-unit">'+o+"</span>"))});var e=_.mapObject(woograbexpress_backend,function(e,o){switch(o){case"default_lat":case"default_lng":case"test_destination_lat":case"test_destination_lng":return parseFloat(e);default:return e}});l.init(e),a()}},maybeOpenModal:function(){woograbexpress_backend.showSettings&&setTimeout(function(){for(var e=!1,o=s(document).find(".wc-shipping-zone-method-type"),r=0;r<o.length;r++){var a=o[r];if(s(a).text()===woograbexpress_backend.methodTitle)return s(a).closest("tr").find(".row-actions .wc-shipping-zone-method-settings").trigger("click"),void(e=!0)}e||(s(".wc-shipping-zone-add-method").trigger("click"),s('select[name="add_method_id"]').val(woograbexpress_backend.methodId).trigger("change"))},500)},submitForm:function(e){e.preventDefault(),l.isEditingAPIKey()?window.alert(t("finish_editing_api")):s("#btn-ok").trigger("click")},toggleStoreOriginFields:function(e){e.preventDefault();var r=s(this).val(),o=s(this).data("fields");_.each(o,function(e,o){_.each(e,function(e){o!==r?s("#"+e).closest("tr").hide():s("#"+e).closest("tr").show()})})},initForm:function(){s(document.body).off("wc_backbone_modal_loaded",o.renderForm),s(document.body).on("wc_backbone_modal_loaded",o.renderForm)},init:function(){o.initForm(),o.maybeOpenModal()}};s(document).ready(o.init)}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvb2dyYWJleHByZXNzLWJhY2tlbmQubWluLmpzIl0sIm5hbWVzIjpbIiQiLCJ3b29ncmFiZXhwcmVzc1RvZ2dsZUJ1dHRvbnMiLCJhcmdzIiwid2hlbiIsInJlbW92ZSIsInRoZW4iLCJoaWRlIiwiYWZ0ZXIiLCJ3cCIsInRlbXBsYXRlIiwiYnV0dG9uRGVmYXVsdCIsImJ0bl9yaWdodCIsImlkIiwiaWNvbiIsImxhYmVsIiwid29vZ3JhYmV4cHJlc3NJMThuIiwid29vZ3JhYmV4cHJlc3NHZXRCdXR0b25zIiwid29vZ3JhYmV4cHJlc3NPYmplY3QiLCJvYmoiLCJwYXRoIiwiZGVmIiwic3BsaXQiLCJjdXJyZW50IiwiaSIsImxlbmd0aCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIndvb2dyYWJleHByZXNzX2JhY2tlbmQiLCJpMThuIiwid29vZ3JhYmV4cHJlc3NFcnJvciIsImVycm9ycyIsInciLCJBIiwiRiIsIk8iLCJjb25zb2xlTWV0aG9kcyIsImZpeENvbnNvbGVNZXRob2QiLCJjb25zb2xlT24iLCJhbGxIYW5kbGVycyIsIm1ldGhvZE9iaiIsImVtcHR5IiwibWV0aG9kTmFtZSIsIm9sZCIsImFyZ3NGb3JBbGwiLCJqIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwiaGFuZGxlcnMiLCJhcHBseSIsInB1c2giLCJjdXIiLCJjYWxsYmFjayIsImtleSIsInRvU3RyaW5nIiwiQ29uc29sZUxpc3RlbmVyIiwib24iLCJ0aGlzIiwid29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIiLCJwYXJhbXMiLCJvcmlnaW5fbGF0Iiwib3JpZ2luX2xuZyIsIm9yaWdpbl9hZGRyZXNzIiwiem9vbUxldmVsIiwiYXBpS2V5RXJyb3JDaGVja0ludGVydmFsIiwiYXBpS2V5RXJyb3IiLCJlZGl0aW5nQVBJS2V5IiwiaW5pdCIsImVycm9yTWVzc2FnZSIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsInJlcGxhY2VXaXRoIiwiY29udmVydEVycm9yIiwiZWFjaCIsImhyZWYiLCJjbGFzcyIsInRleHQiLCJkb2N1bWVudCIsIm9mZiIsInByb3AiLCJoYXNDbGFzcyIsImRhdGEiLCJ2YWwiLCJ1bmRlZmluZWQiLCJoYW5kbGVBcGlLZXlJbnB1dCIsImVkaXRBcGlLZXkiLCJ0cmlnZ2VyIiwic2hvd0xvY2F0aW9uUGlja2VyIiwiaGlkZUxvY2F0aW9uUGlja2VyIiwiYXBwbHlMb2NhdGlvblBpY2tlciIsInRvZ2dsZU1hcFNlYXJjaCIsInZhbGlkYXRlQVBJS2V5Qm90aFNpZGUiLCIkaW5wdXQiLCJ2YWxpZGF0ZUFQSUtleVNlcnZlclNpZGUiLCJ2YWxpZGF0ZUFQSUtleUJyb3dzZXJTaWRlIiwiaW5pdE1hcCIsImdlb2NvZGVyQXJncyIsImxhdExuZyIsImdvb2dsZSIsIm1hcHMiLCJMYXRMbmciLCJwYXJzZUZsb2F0IiwiZGVmYXVsdExhdCIsImRlZmF1bHRMbmciLCJHZW9jb2RlciIsImdlb2NvZGUiLCJyZXN1bHRzIiwic3RhdHVzIiwiYWRkQ2xhc3MiLCJzZXRUaW1lb3V0IiwicmVtb3ZlQ2xhc3MiLCJjbGVhckludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJzaG93RXJyb3IiLCJvblN1Y2Nlc3MiLCJhamF4IiwibWV0aG9kIiwidXJsIiwiYWpheF91cmwiLCJhY3Rpb24iLCJub25jZSIsInZhbGlkYXRlX2FwaV9rZXlfbm9uY2UiLCJkb25lIiwicmVzcG9uc2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwic3RhdHVzVGV4dCIsImFwcGVuZFRvIiwiY2xvc2VzdCIsInNsaWRlRG93biIsInJlbW92ZUVycm9yIiwiZmluZCIsInJlcGxhY2UiLCJlIiwiY3VycmVudFRhcmdldCIsIm5leHQiLCJwcmV2ZW50RGVmYXVsdCIsImJsdXIiLCJwcmV2IiwiYXR0ciIsImV2ZW50IiwiYXBpX2tleV9waWNrZXIiLCJpc0VkaXRpbmdBUElLZXkiLCJ3aW5kb3ciLCJhbGVydCIsImJ0bl9sZWZ0IiwiZmFkZUluIiwic2libGluZ3MiLCIkc3ViVGl0bGUiLCJmaXJzdCIsImFwcGVuZCIsInJlbmRlck1hcCIsImRlc3Ryb3lNYXAiLCJzaG93Iiwibm90IiwidG9nZ2xlQ2xhc3MiLCJhcGlLZXkiLCJfIiwiaXNFbXB0eSIsImdldFNjcmlwdCIsImN1cnJlbnRMYXRMbmciLCJsYXQiLCJsbmciLCJtYXAiLCJNYXAiLCJnZXRFbGVtZW50QnlJZCIsIm1hcFR5cGVJZCIsImNlbnRlciIsInpvb20iLCJzdHJlZXRWaWV3Q29udHJvbCIsIm1hcFR5cGVDb250cm9sIiwibWFya2VyIiwiTWFya2VyIiwicG9zaXRpb24iLCJkcmFnZ2FibGUiLCJpbmZvd2luZG93IiwiSW5mb1dpbmRvdyIsIm1heFdpZHRoIiwic2V0Q29udGVudCIsImRyYWdfbWFya2VyIiwib3BlbiIsInNldExhdExuZyIsImFkZExpc3RlbmVyIiwiY2xvc2UiLCJwcmVwZW5kIiwiY29udHJvbHMiLCJDb250cm9sUG9zaXRpb24iLCJUT1BfTEVGVCIsIm1hcFNlYXJjaEJveCIsInBsYWNlcyIsIlNlYXJjaEJveCIsInNldEJvdW5kcyIsImdldEJvdW5kcyIsIm1hcmtlcnMiLCJnZXRQbGFjZXMiLCJmb3JFYWNoIiwic2V0TWFwIiwiYm91bmRzIiwiTGF0TG5nQm91bmRzIiwicGxhY2UiLCJnZW9tZXRyeSIsImxvY2F0aW9uIiwidmlld3BvcnQiLCJ1bmlvbiIsImV4dGVuZCIsImZpdEJvdW5kcyIsIkdlb2NvZGVyU3RhdHVzIiwiT0siLCJpbmZvd2luZG93Q29udGVudHMiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsImpvaW4iLCJmb3JtYXR0ZWRfYWRkcmVzcyIsInNldENlbnRlciIsIndvb2dyYWJleHByZXNzQmFja2VuZCIsInJlbmRlckZvcm0iLCJzdWJtaXRGb3JtIiwidG9nZ2xlU3RvcmVPcmlnaW5GaWVsZHMiLCIkdGFibGUiLCIkZmllbGRHcm91cCIsImZpZWxkR3JvdXBJZCIsIiRmaWVsZEdyb3VwRGVzY3JpcHRpb24iLCJkZXRhY2giLCIkZmllbGRHcm91cFRhYmxlIiwibmV4dEFsbCIsIndyYXAiLCIkZmllbGQiLCJmaWVsZFVuaXQiLCJtYXBPYmplY3QiLCJtYXliZU9wZW5Nb2RhbCIsInNob3dTZXR0aW5ncyIsImlzTWV0aG9kQWRkZWQiLCJtZXRob2RzIiwibWV0aG9kVGl0bGUiLCJtZXRob2RJZCIsInNlbGVjdGVkIiwiZmllbGRzIiwiZmllbGRJZHMiLCJmaWVsZFZhbHVlIiwiZmllbGRJZCIsImluaXRGb3JtIiwiYm9keSIsInJlYWR5IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQyxTQUFTQSxHQWtCVixTQUFTQyxFQUE0QkMsR0FDcENGLEVBQUVHLEtBQUtILEVBQUUsMkJBQTJCSSxVQUFVQyxLQUFLLFdBQ2xETCxFQUFFLFdBQVdNLE9BQU9DLE1BQU1DLEdBQUdDLFNBQVMseUJBQVpELENBSTVCLFNBQWtDTixHQUNqQyxJQUFJUSxFQUFnQixDQUNuQkMsVUFBVyxDQUNWQyxHQUFJLGdCQUNKQyxLQUFNLE1BQ05DLE1BQU9DLEVBQW1CLDBCQUk1QixPQUFLYixHQUNHUSxFQWR5RE0sQ0FBeUJkLE9Bb0IzRixTQUFTZSxFQUFxQkMsRUFBS0MsRUFBTUMsR0FDcEIsaUJBQVRELElBQ1ZBLEVBQU9BLEVBQUtFLE1BQU0sTUFHbkIsSUFLQyxJQUhBLElBQUlDLEVBQVVKLEVBR0xLLEVBQUksRUFBR0EsRUFBSUosRUFBS0ssT0FBUUQsSUFDaENELEVBQVVBLEVBQVFILEVBQUtJLElBR3hCLE9BQU9ELEVBQ04sTUFBT0csR0FHUixPQUZBQyxRQUFRQyxJQUFJLHVCQUF3QkYsR0FFN0JMLEdBSVQsU0FBU0wsRUFBbUJJLEVBQU1DLEdBQ2pDLE9BQU9ILEVBQXFCVyx1QkFBdUJDLEtBQU1WLEVBQU1DLEdBR2hFLFNBQVNVLEVBQW9CWCxFQUFNQyxHQUNsQyxPQUFPSCxFQUFxQlcsdUJBQXVCQyxLQUFLRSxPQUFRWixFQUFNQyxJQXVNdEUsU0FBVVksR0FDVCxhQUVBLElBQUlDLEVBQUdDLEVBQUdDLEVBQUdDLEVBQWdCQyxFQUFrQkMsRUFDN0NDLEVBQWFDLEVBd0JIQyxFQXRCWlIsRUFBSSxHQUNKQyxFQUFJLGFB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QVEsTUFBTTNILE9BRS9CTixFQUFFLElBQU1nUCxHQUFTL0csUUFBUSxNQUFNeUIsWUFLbkN1RixTQUFVLFdBRVRqUCxFQUFFOEUsU0FBU29LLE1BQU1uSyxJQUFJLDJCQUE0QndJLEVBQXNCQyxZQUN2RXhOLEVBQUU4RSxTQUFTb0ssTUFBTXpMLEdBQUcsMkJBQTRCOEosRUFBc0JDLGFBRXZFcEosS0FBTSxXQUNMbUosRUFBc0IwQixXQUN0QjFCLEVBQXNCZSxtQkFJeEJ0TyxFQUFFOEUsVUFBVXFLLE1BQU01QixFQUFzQm5KLE1BeDhCeEMsQ0F5OEJFZ0wiLCJmaWxlIjoid29vZ3JhYmV4cHJlc3MtYmFja2VuZC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCkge1xuLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdFxuLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxuLy8gTiBtaWxsaXNlY29uZHMuXG5mdW5jdGlvbiB3b29ncmFiZXhwcmVzc0RlYm91bmNlKGZ1bmMsIHdhaXQpIHtcblx0dmFyIHRpbWVvdXQ7XG5cdHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGNvbnRleHQgPSB0aGlzO1xuXHRcdHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcdHZhciBsYXRlciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHRpbWVvdXQgPSBudWxsO1xuXHRcdFx0ZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0XHR9O1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG5cdH07XG59XG5cbmZ1bmN0aW9uIHdvb2dyYWJleHByZXNzVG9nZ2xlQnV0dG9ucyhhcmdzKSB7XG5cdCQud2hlbigkKCcjd29vZ3JhYmV4cHJlc3MtYnV0dG9ucycpLnJlbW92ZSgpKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHQkKCcjYnRuLW9rJykuaGlkZSgpLmFmdGVyKHdwLnRlbXBsYXRlKCd3b29ncmFiZXhwcmVzcy1idXR0b25zJykod29vZ3JhYmV4cHJlc3NHZXRCdXR0b25zKGFyZ3MpKSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiB3b29ncmFiZXhwcmVzc0dldEJ1dHRvbnMoYXJncykge1xuXHR2YXIgYnV0dG9uRGVmYXVsdCA9IHtcblx0XHRidG5fcmlnaHQ6IHtcblx0XHRcdGlkOiAnc2F2ZS1zZXR0aW5ncycsXG5cdFx0XHRpY29uOiAneWVzJyxcblx0XHRcdGxhYmVsOiB3b29ncmFiZXhwcmVzc0kxOG4oJ2J1dHRvbnMuU2F2ZSBDaGFuZ2VzJyksXG5cdFx0fSxcblx0fTtcblxuXHRpZiAoIWFyZ3MpIHtcblx0XHRyZXR1cm4gYnV0dG9uRGVmYXVsdDtcblx0fVxuXG5cdHJldHVybiBhcmdzO1xufVxuXG5mdW5jdGlvbiB3b29ncmFiZXhwcmVzc09iamVjdChvYmosIHBhdGgsIGRlZikge1xuXHRpZiAodHlwZW9mIHBhdGggPT09ICdzdHJpbmcnKSB7XG5cdFx0cGF0aCA9IHBhdGguc3BsaXQoJy4nKTtcblx0fVxuXG5cdHRyeSB7XG5cdFx0Ly8gQ2FjaGUgdGhlIGN1cnJlbnQgb2JqZWN0XG5cdFx0dmFyIGN1cnJlbnQgPSBvYmo7XG5cblx0XHQvLyBGb3IgZWFjaCBpdGVtIGluIHRoZSBwYXRoLCBkaWcgaW50byB0aGUgb2JqZWN0XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRjdXJyZW50ID0gY3VycmVudFtwYXRoW2ldXTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY3VycmVudDtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmxvZygnd29vZ3JhYmV4cHJlc3NPYmplY3QnLCBlcnJvcik7XG5cblx0XHRyZXR1cm4gZGVmO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHdvb2dyYWJleHByZXNzSTE4bihwYXRoLCBkZWYpIHtcblx0cmV0dXJuIHdvb2dyYWJleHByZXNzT2JqZWN0KHdvb2dyYWJleHByZXNzX2JhY2tlbmQuaTE4biwgcGF0aCwgZGVmKTtcbn1cblxuZnVuY3Rpb24gd29vZ3JhYmV4cHJlc3NFcnJvcihwYXRoLCBkZWYpIHtcblx0cmV0dXJuIHdvb2dyYWJleHByZXNzT2JqZWN0KHdvb2dyYWJleHByZXNzX2JhY2tlbmQuaTE4bi5lcnJvcnMsIHBhdGgsIGRlZik7XG59XG5cbmZ1bmN0aW9uIHdvb2dyYWJleHByZXNzU3ByaW50ZigpIHtcblx0Ly8gIGRpc2N1c3MgYXQ6IGh0dHBzOi8vbG9jdXR1cy5pby9waHAvc3ByaW50Zi9cblx0Ly8gb3JpZ2luYWwgYnk6IEFzaCBTZWFybGUgKGh0dHBzOi8vaGV4bWVuLmNvbS9ibG9nLylcblx0Ly8gaW1wcm92ZWQgYnk6IE1pY2hhZWwgV2hpdGUgKGh0dHBzOi8vZ2V0c3ByaW5rLmNvbSlcblx0Ly8gaW1wcm92ZWQgYnk6IEphY2tcblx0Ly8gaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHBzOi8va3Z6LmlvKVxuXHQvLyBpbXByb3ZlZCBieTogS2V2aW4gdmFuIFpvbm5ldmVsZCAoaHR0cHM6Ly9rdnouaW8pXG5cdC8vIGltcHJvdmVkIGJ5OiBLZXZpbiB2YW4gWm9ubmV2ZWxkIChodHRwczovL2t2ei5pbylcblx0Ly8gaW1wcm92ZWQgYnk6IERqXG5cdC8vIGltcHJvdmVkIGJ5OiBBbGxpZHlsbHNcblx0Ly8gICAgaW5wdXQgYnk6IFBhdWxvIEZyZWl0YXNcblx0Ly8gICAgaW5wdXQgYnk6IEJyZXR0IFphbWlyIChodHRwczovL2JyZXR0LXphbWlyLm1lKVxuXHQvLyBpbXByb3ZlZCBieTogUmFmYcWCIEt1a2F3c2tpIChodHRwczovL2t1a2F3c2tpLnBsKVxuXHQvLyAgIGV4YW1wbGUgMTogc3ByaW50ZihcIiUwMS4yZlwiLCAxMjMuMSlcblx0Ly8gICByZXR1cm5zIDE6ICcxMjMuMTAnXG5cdC8vICAgZXhhbXBsZSAyOiBzcHJpbnRmKFwiWyUxMHNdXCIsICdtb25rZXknKVxuXHQvLyAgIHJldHVybnMgMjogJ1sgICAgbW9ua2V5XSdcblx0Ly8gICBleGFtcGxlIDM6IHNwcmludGYoXCJbJScjMTBzXVwiLCAnbW9ua2V5Jylcblx0Ly8gICByZXR1cm5zIDM6ICdbIyMjI21vbmtleV0nXG5cdC8vICAgZXhhbXBsZSA0OiBzcHJpbnRmKFwiJWRcIiwgMTIzNDU2Nzg5MDEyMzQ1KVxuXHQvLyAgIHJldHVybnMgNDogJzEyMzQ1Njc4OTAxMjM0NSdcblx0Ly8gICBleGFtcGxlIDU6IHNwcmludGYoJyUtMDNzJywgJ0UnKVxuXHQvLyAgIHJldHVybnMgNTogJ0UwMCdcblx0Ly8gICBleGFtcGxlIDY6IHNwcmludGYoJyUrMDEwZCcsIDkpXG5cdC8vICAgcmV0dXJucyA2OiAnKzAwMDAwMDAwOSdcblx0Ly8gICBleGFtcGxlIDc6IHNwcmludGYoJyUrMFxcJ0AxMGQnLCA5KVxuXHQvLyAgIHJldHVybnMgNzogJ0BAQEBAQEBAKzknXG5cdC8vICAgZXhhbXBsZSA4OiBzcHJpbnRmKCclLmYnLCAzLjE0KVxuXHQvLyAgIHJldHVybnMgODogJzMuMTQwMDAwJ1xuXHQvLyAgIGV4YW1wbGUgOTogc3ByaW50ZignJSUgJTIkZCcsIDEsIDIpXG5cdC8vICAgcmV0dXJucyA5OiAnJSAyJ1xuXG5cdHZhciByZWdleCA9IC8lJXwlKD86KFxcZCspXFwkKT8oKD86Wy0rIzAgXXwnW1xcc1xcU10pKikoXFxkKyk/KD86XFwuKFxcZCopKT8oW1xcc1xcU10pL2dcblx0dmFyIGFyZ3MgPSBhcmd1bWVudHNcblx0dmFyIGkgPSAwXG5cdHZhciBmb3JtYXQgPSBhcmdzW2krK11cblxuXHR2YXIgX3BhZCA9IGZ1bmN0aW9uIChzdHIsIGxlbiwgY2hyLCBsZWZ0SnVzdGlmeSkge1xuXHRcdGlmICghY2hyKSB7XG5cdFx0XHRjaHIgPSAnICdcblx0XHR9XG5cdFx0dmFyIHBhZGRpbmcgPSAoc3RyLmxlbmd0aCA+PSBsZW4pID8gJycgOiBuZXcgQXJyYXkoMSArIGxlbiAtIHN0ci5sZW5ndGggPj4+IDApLmpvaW4oY2hyKVxuXHRcdHJldHVybiBsZWZ0SnVzdGlmeSA/IHN0ciArIHBhZGRpbmcgOiBwYWRkaW5nICsgc3RyXG5cdH1cblxuXHR2YXIganVzdGlmeSA9IGZ1bmN0aW9uICh2YWx1ZSwgcHJlZml4LCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHBhZENoYXIpIHtcblx0XHR2YXIgZGlmZiA9IG1pbldpZHRoIC0gdmFsdWUubGVuZ3RoXG5cdFx0aWYgKGRpZmYgPiAwKSB7XG5cdFx0XHQvLyB3aGVuIHBhZGRpbmcgd2l0aCB6ZXJvc1xuXHRcdFx0Ly8gb24gdGhlIGxlZnQgc2lkZVxuXHRcdFx0Ly8ga2VlcCBzaWduICgrIG9yIC0pIGluIGZyb250XG5cdFx0XHRpZiAoIWxlZnRKdXN0aWZ5ICYmIHBhZENoYXIgPT09ICcwJykge1xuXHRcdFx0XHR2YWx1ZSA9IFtcblx0XHRcdFx0XHR2YWx1ZS5zbGljZSgwLCBwcmVmaXgubGVuZ3RoKSxcblx0XHRcdFx0XHRfcGFkKCcnLCBkaWZmLCAnMCcsIHRydWUpLFxuXHRcdFx0XHRcdHZhbHVlLnNsaWNlKHByZWZpeC5sZW5ndGgpXG5cdFx0XHRcdF0uam9pbignJylcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhbHVlID0gX3BhZCh2YWx1ZSwgbWluV2lkdGgsIHBhZENoYXIsIGxlZnRKdXN0aWZ5KVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWVcblx0fVxuXG5cdHZhciBfZm9ybWF0QmFzZVggPSBmdW5jdGlvbiAodmFsdWUsIGJhc2UsIGxlZnRKdXN0aWZ5LCBtaW5XaWR0aCwgcHJlY2lzaW9uLCBwYWRDaGFyKSB7XG5cdFx0Ly8gTm90ZTogY2FzdHMgbmVnYXRpdmUgbnVtYmVycyB0byBwb3NpdGl2ZSBvbmVzXG5cdFx0dmFyIG51bWJlciA9IHZhbHVlID4+PiAwXG5cdFx0dmFsdWUgPSBfcGFkKG51bWJlci50b1N0cmluZyhiYXNlKSwgcHJlY2lzaW9uIHx8IDAsICcwJywgZmFsc2UpXG5cdFx0cmV0dXJuIGp1c3RpZnkodmFsdWUsICcnLCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHBhZENoYXIpXG5cdH1cblxuXHQvLyBfZm9ybWF0U3RyaW5nKClcblx0dmFyIF9mb3JtYXRTdHJpbmcgPSBmdW5jdGlvbiAodmFsdWUsIGxlZnRKdXN0aWZ5LCBtaW5XaWR0aCwgcHJlY2lzaW9uLCBjdXN0b21QYWRDaGFyKSB7XG5cdFx0aWYgKHByZWNpc2lvbiAhPT0gbnVsbCAmJiBwcmVjaXNpb24gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dmFsdWUgPSB2YWx1ZS5zbGljZSgwLCBwcmVjaXNpb24pXG5cdFx0fVxuXHRcdHJldHVybiBqdXN0aWZ5KHZhbHVlLCAnJywgbGVmdEp1c3RpZnksIG1pbldpZHRoLCBjdXN0b21QYWRDaGFyKVxuXHR9XG5cblx0Ly8gZG9Gb3JtYXQoKVxuXHR2YXIgZG9Gb3JtYXQgPSBmdW5jdGlvbiAoc3Vic3RyaW5nLCBhcmdJbmRleCwgbW9kaWZpZXJzLCBtaW5XaWR0aCwgcHJlY2lzaW9uLCBzcGVjaWZpZXIpIHtcblx0XHR2YXIgbnVtYmVyLCBwcmVmaXgsIG1ldGhvZCwgdGV4dFRyYW5zZm9ybSwgdmFsdWVcblxuXHRcdGlmIChzdWJzdHJpbmcgPT09ICclJScpIHtcblx0XHRcdHJldHVybiAnJSdcblx0XHR9XG5cblx0XHQvLyBwYXJzZSBtb2RpZmllcnNcblx0XHR2YXIgcGFkQ2hhciA9ICcgJyAvLyBwYWQgd2l0aCBzcGFjZXMgYnkgZGVmYXVsdFxuXHRcdHZhciBsZWZ0SnVzdGlmeSA9IGZhbHNlXG5cdFx0dmFyIHBvc2l0aXZlTnVtYmVyUHJlZml4ID0gJydcblx0XHR2YXIgaiwgbFxuXG5cdFx0Zm9yIChqID0gMCwgbCA9IG1vZGlmaWVycy5sZW5ndGg7IGogPCBsOyBqKyspIHtcblx0XHRcdHN3aXRjaCAobW9kaWZpZXJzLmNoYXJBdChqKSkge1xuXHRcdFx0XHRjYXNlICcgJzpcblx0XHRcdFx0Y2FzZSAnMCc6XG5cdFx0XHRcdFx0cGFkQ2hhciA9IG1vZGlmaWVycy5jaGFyQXQoailcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRjYXNlICcrJzpcblx0XHRcdFx0XHRwb3NpdGl2ZU51bWJlclByZWZpeCA9ICcrJ1xuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgJy0nOlxuXHRcdFx0XHRcdGxlZnRKdXN0aWZ5ID0gdHJ1ZVxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgXCInXCI6XG5cdFx0XHRcdFx0aWYgKGogKyAxIDwgbCkge1xuXHRcdFx0XHRcdFx0cGFkQ2hhciA9IG1vZGlmaWVycy5jaGFyQXQoaiArIDEpXG5cdFx0XHRcdFx0XHRqKytcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIW1pbldpZHRoKSB7XG5cdFx0XHRtaW5XaWR0aCA9IDBcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWluV2lkdGggPSArbWluV2lkdGhcblx0XHR9XG5cblx0XHRpZiAoIWlzRmluaXRlKG1pbldpZHRoKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdXaWR0aCBtdXN0IGJlIGZpbml0ZScpXG5cdFx0fVxuXG5cdFx0aWYgKCFwcmVjaXNpb24pIHtcblx0XHRcdHByZWNpc2lvbiA9IChzcGVjaWZpZXIgPT09ICdkJykgPyAwIDogJ2ZGZUUnLmluZGV4T2Yoc3BlY2lmaWVyKSA+IC0xID8gNiA6IHVuZGVmaW5lZFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRwcmVjaXNpb24gPSArcHJlY2lzaW9uXG5cdFx0fVxuXG5cdFx0aWYgKGFyZ0luZGV4ICYmICthcmdJbmRleCA9PT0gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdBcmd1bWVudCBudW1iZXIgbXVzdCBiZSBncmVhdGVyIHRoYW4gemVybycpXG5cdFx0fVxuXG5cdFx0aWYgKGFyZ0luZGV4ICYmICthcmdJbmRleCA+PSBhcmdzLmxlbmd0aCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdUb28gZmV3IGFyZ3VtZW50cycpXG5cdFx0fVxuXG5cdFx0dmFsdWUgPSBhcmdJbmRleCA/IGFyZ3NbK2FyZ0luZGV4XSA6IGFyZ3NbaSsrXVxuXG5cdFx0c3dpdGNoIChzcGVjaWZpZXIpIHtcblx0XHRcdGNhc2UgJyUnOlxuXHRcdFx0XHRyZXR1cm4gJyUnXG5cdFx0XHRjYXNlICdzJzpcblx0XHRcdFx0cmV0dXJuIF9mb3JtYXRTdHJpbmcodmFsdWUgKyAnJywgbGVmdEp1c3RpZnksIG1pbldpZHRoLCBwcmVjaXNpb24sIHBhZENoYXIpXG5cdFx0XHRjYXNlICdjJzpcblx0XHRcdFx0cmV0dXJuIF9mb3JtYXRTdHJpbmcoU3RyaW5nLmZyb21DaGFyQ29kZSgrdmFsdWUpLCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHByZWNpc2lvbiwgcGFkQ2hhcilcblx0XHRcdGNhc2UgJ2InOlxuXHRcdFx0XHRyZXR1cm4gX2Zvcm1hdEJhc2VYKHZhbHVlLCAyLCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHByZWNpc2lvbiwgcGFkQ2hhcilcblx0XHRcdGNhc2UgJ28nOlxuXHRcdFx0XHRyZXR1cm4gX2Zvcm1hdEJhc2VYKHZhbHVlLCA4LCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHByZWNpc2lvbiwgcGFkQ2hhcilcblx0XHRcdGNhc2UgJ3gnOlxuXHRcdFx0XHRyZXR1cm4gX2Zvcm1hdEJhc2VYKHZhbHVlLCAxNiwgbGVmdEp1c3RpZnksIG1pbldpZHRoLCBwcmVjaXNpb24sIHBhZENoYXIpXG5cdFx0XHRjYXNlICdYJzpcblx0XHRcdFx0cmV0dXJuIF9mb3JtYXRCYXNlWCh2YWx1ZSwgMTYsIGxlZnRKdXN0aWZ5LCBtaW5XaWR0aCwgcHJlY2lzaW9uLCBwYWRDaGFyKVxuXHRcdFx0XHRcdC50b1VwcGVyQ2FzZSgpXG5cdFx0XHRjYXNlICd1Jzpcblx0XHRcdFx0cmV0dXJuIF9mb3JtYXRCYXNlWCh2YWx1ZSwgMTAsIGxlZnRKdXN0aWZ5LCBtaW5XaWR0aCwgcHJlY2lzaW9uLCBwYWRDaGFyKVxuXHRcdFx0Y2FzZSAnaSc6XG5cdFx0XHRjYXNlICdkJzpcblx0XHRcdFx0bnVtYmVyID0gK3ZhbHVlIHx8IDBcblx0XHRcdFx0Ly8gUGxhaW4gTWF0aC5yb3VuZCBkb2Vzbid0IGp1c3QgdHJ1bmNhdGVcblx0XHRcdFx0bnVtYmVyID0gTWF0aC5yb3VuZChudW1iZXIgLSBudW1iZXIgJSAxKVxuXHRcdFx0XHRwcmVmaXggPSBudW1iZXIgPCAwID8gJy0nIDogcG9zaXRpdmVOdW1iZXJQcmVmaXhcblx0XHRcdFx0dmFsdWUgPSBwcmVmaXggKyBfcGFkKFN0cmluZyhNYXRoLmFicyhudW1iZXIpKSwgcHJlY2lzaW9uLCAnMCcsIGZhbHNlKVxuXG5cdFx0XHRcdGlmIChsZWZ0SnVzdGlmeSAmJiBwYWRDaGFyID09PSAnMCcpIHtcblx0XHRcdFx0XHQvLyBjYW4ndCByaWdodC1wYWQgMHMgb24gaW50ZWdlcnNcblx0XHRcdFx0XHRwYWRDaGFyID0gJyAnXG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGp1c3RpZnkodmFsdWUsIHByZWZpeCwgbGVmdEp1c3RpZnksIG1pbldpZHRoLCBwYWRDaGFyKVxuXHRcdFx0Y2FzZSAnZSc6XG5cdFx0XHRjYXNlICdFJzpcblx0XHRcdGNhc2UgJ2YnOiAvLyBAdG9kbzogU2hvdWxkIGhhbmRsZSBsb2NhbGVzIChhcyBwZXIgc2V0bG9jYWxlKVxuXHRcdFx0Y2FzZSAnRic6XG5cdFx0XHRjYXNlICdnJzpcblx0XHRcdGNhc2UgJ0cnOlxuXHRcdFx0XHRudW1iZXIgPSArdmFsdWVcblx0XHRcdFx0cHJlZml4ID0gbnVtYmVyIDwgMCA/ICctJyA6IHBvc2l0aXZlTnVtYmVyUHJlZml4XG5cdFx0XHRcdG1ldGhvZCA9IFsndG9FeHBvbmVudGlhbCcsICd0b0ZpeGVkJywgJ3RvUHJlY2lzaW9uJ11bJ2VmZycuaW5kZXhPZihzcGVjaWZpZXIudG9Mb3dlckNhc2UoKSldXG5cdFx0XHRcdHRleHRUcmFuc2Zvcm0gPSBbJ3RvU3RyaW5nJywgJ3RvVXBwZXJDYXNlJ11bJ2VFZkZnRycuaW5kZXhPZihzcGVjaWZpZXIpICUgMl1cblx0XHRcdFx0dmFsdWUgPSBwcmVmaXggKyBNYXRoLmFicyhudW1iZXIpW21ldGhvZF0ocHJlY2lzaW9uKVxuXHRcdFx0XHRyZXR1cm4ganVzdGlmeSh2YWx1ZSwgcHJlZml4LCBsZWZ0SnVzdGlmeSwgbWluV2lkdGgsIHBhZENoYXIpW3RleHRUcmFuc2Zvcm1dKClcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdC8vIHVua25vd24gc3BlY2lmaWVyLCBjb25zdW1lIHRoYXQgY2hhciBhbmQgcmV0dXJuIGVtcHR5XG5cdFx0XHRcdHJldHVybiAnJ1xuXHRcdH1cblx0fVxuXG5cdHRyeSB7XG5cdFx0cmV0dXJuIGZvcm1hdC5yZXBsYWNlKHJlZ2V4LCBkb0Zvcm1hdClcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cmV0dXJuIGZhbHNlXG5cdH1cbn1cblxuKGZ1bmN0aW9uICh3KSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgQSwgRiwgTywgY29uc29sZU1ldGhvZHMsIGZpeENvbnNvbGVNZXRob2QsIGNvbnNvbGVPbixcbiAgICBhbGxIYW5kbGVycywgbWV0aG9kT2JqO1xuXG4gIEEgPSBbXTtcbiAgRiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuOyB9O1xuICBPID0ge307XG5cbiAgLy8gQWxsIHBvc3NpYmxlIHN0YW5kYXJkIG1ldGhvZHMgdG8gcHJvdmlkZSBhbiBpbnRlcmZhY2UgZm9yXG4gIGNvbnNvbGVNZXRob2RzID0gW1xuICAgICdhc3NlcnQnLCAnY2xlYXInLCAnY291bnQnLCAnZGVidWcnLFxuICAgICdkaXInLCAnZGlyeG1sJywgJ2Vycm9yJywgJ2V4Y2VwdGlvbicsXG4gICAgJ2dyb3VwJywgJ2dyb3VwQ29sbGFwc2VkJywgJ2dyb3VwRW5kJyxcbiAgICAnaW5mbycsICdsb2cnLCAncHJvZmlsZScsICdwcm9maWxlRW5kJyxcbiAgICAndGFibGUnLCAndGltZScsICd0aW1lRW5kJywgJ3RpbWVTdGFtcCcsXG4gICAgJ3RyYWNlJywgJ3dhcm4nXG4gIF07XG5cbiAgLy8gSG9sZHMgaGFuZGxlcnMgdG8gYmUgZXhlY3V0ZWQgZm9yIGV2ZXJ5IG1ldGhvZFxuICBhbGxIYW5kbGVycyA9IFtdO1xuXG4gIC8vIEhvbGRzIGhhbmRsZXJzIHBlciBtZXRob2RcbiAgbWV0aG9kT2JqID0ge307XG5cbiAgLy8gT3ZlcnJpZGVzIHRoZSBleGlzdGluZyBjb25zb2xlIG1ldGhvZHMsIHRvIGNhbGwgYW55IHN0b3JlZCBoYW5kbGVycyBmaXJzdFxuICBmaXhDb25zb2xlTWV0aG9kID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZnVuYywgZW1wdHk7XG5cbiAgICBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBGO1xuICAgIH07XG5cbiAgICBpZiAody5jb25zb2xlKSB7XG4gICAgICAvLyBJZiBgY29uc29sZWAgaXMgZXZlbiBhdmFpbGFibGVcbiAgICAgIGZ1bmMgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSkge1xuICAgICAgICB2YXIgb2xkO1xuICAgICAgICBpZiAobWV0aG9kTmFtZSBpbiBjb25zb2xlICYmIChvbGQgPSBjb25zb2xlW21ldGhvZE5hbWVdKSkge1xuICAgICAgICAgIC8vIENoZWNrcyB0byBzZWUgaWYgYG1ldGhvZE5hbWVgIGlzIGRlZmluZWQgb24gYGNvbnNvbGVgIGFuZCBoYXMgdmFsaWQgZnVuY3Rpb24gdG8gZXhlY3V0ZVxuICAgICAgICAgIC8vIChhbmQgc3RvcmVzIHRoZSBvbGQgaGFuZGxlcilcbiAgICAgICAgICAvLyBUaGlzIGlzIGltcG9ydGFudCBzbyB0aGF0IHVuZGVmaW5lZCBtZXRob2RzIGFyZW4ndCBmaWxsZWQgaW5cbiAgICAgICAgICBjb25zb2xlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gT3ZlcndyaXRlcyBjdXJyZW50IGNvbnNvbGUgbWV0aG9kIHdpdGggdGhpcyBmdW5jdGlvblxuICAgICAgICAgICAgdmFyIGFyZ3MsIGFyZ3NGb3JBbGwsIGksIGo7XG4gICAgICAgICAgICAvLyBDb3B5IGFsbCBhcmd1bWVudHMgcGFzc2VkIHRvIGhhbmRsZXJcbiAgICAgICAgICAgIGFyZ3MgPSBBLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGogPSBtZXRob2RPYmpbbWV0aG9kTmFtZV0uaGFuZGxlcnMubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICAgIC8vIExvb3Agb3ZlciBhbGwgc3RvcmVkIGhhbmRsZXJzIGZvciB0aGlzIHNwZWNpZmljIG1ldGhvZCBhbmQgY2FsbCB0aGVtXG4gICAgICAgICAgICAgIEYuYXBwbHkuY2FsbChtZXRob2RPYmpbbWV0aG9kTmFtZV0uaGFuZGxlcnNbaV0sIGNvbnNvbGUsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMCwgaiA9IGFsbEhhbmRsZXJzLmxlbmd0aDsgaSA8IGo7IGkrKykge1xuICAgICAgICAgICAgICAvLyBMb29wIG92ZXIgYWxsIHN0b3JlZCBoYW5kbGVycyBmb3IgQUxMIGV2ZW50cyBhbmQgY2FsbCB0aGVtXG4gICAgICAgICAgICAgIGFyZ3NGb3JBbGwgPSBbbWV0aG9kTmFtZV07XG4gICAgICAgICAgICAgIEEucHVzaC5hcHBseShhcmdzRm9yQWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgRi5hcHBseS5jYWxsKGFsbEhhbmRsZXJzW2ldLCBjb25zb2xlLCBhcmdzRm9yQWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENhbGxzIG9sZFxuICAgICAgICAgICAgRi5hcHBseS5jYWxsKG9sZCwgY29uc29sZSwgYXJncyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uc29sZVttZXRob2ROYW1lXSB8fCBlbXB0eTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGZ1bmMgPSBlbXB0eTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuYztcbiAgfSgpKTtcblxuICAvLyBMb29wIHRocm91Z2ggYWxsIHN0YW5kYXJkIGNvbnNvbGUgbWV0aG9kcyBhbmQgYWRkIGEgd3JhcHBlciBmdW5jdGlvbiB0aGF0IGNhbGxzIHN0b3JlZCBoYW5kbGVyc1xuICAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBpLCBqLCBjdXI7XG4gICAgZm9yIChpID0gMCwgaiA9IGNvbnNvbGVNZXRob2RzLmxlbmd0aDsgaSA8IGo7IGkrKykge1xuICAgICAgLy8gTG9vcCB0aHJvdWdoIGFsbCB2YWxpZCBjb25zb2xlIG1ldGhvZHNcbiAgICAgIGN1ciA9IGNvbnNvbGVNZXRob2RzW2ldO1xuICAgICAgbWV0aG9kT2JqW2N1cl0gPSB7XG4gICAgICAgIGhhbmRsZXJzOiBbXVxuICAgICAgfTtcbiAgICAgIGZpeENvbnNvbGVNZXRob2QoY3VyKTtcbiAgICB9XG4gIH0oKSk7XG5cbiAgLy8gTWFpbiBoYW5kbGVyIGV4cG9zZWRcbiAgY29uc29sZU9uID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGtleSwgY3VyO1xuICAgIGlmIChPLnRvU3RyaW5nLmNhbGwobWV0aG9kTmFtZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAvLyBPYmplY3QgbGl0ZXJhbCBwcm92aWRlZCBhcyBmaXJzdCBhcmd1bWVudFxuICAgICAgZm9yIChrZXkgaW4gbWV0aG9kTmFtZSkge1xuICAgICAgICAvLyBMb29wIHRocm91Z2ggYWxsIGtleXMgaW4gb2JqZWN0IGxpdGVyYWxcbiAgICAgICAgY3VyID0gbWV0aG9kTmFtZVtrZXldO1xuICAgICAgICBpZiAoa2V5ID09PSAnYWxsJykge1xuICAgICAgICAgIC8vIElmIHRhcmdldGluZyBhbGwgZXZlbnRzXG4gICAgICAgICAgYWxsSGFuZGxlcnMucHVzaChjdXIpO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSBpbiBtZXRob2RPYmopIHtcbiAgICAgICAgICAvLyBJZiB0YXJnZXRpbmcgc3BlY2lmaWMgdmFsaWQgZXZlbnRcbiAgICAgICAgICBtZXRob2RPYmpba2V5XS5oYW5kbGVycy5wdXNoKGN1cik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXRob2ROYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBGdW5jdGlvbiBwcm92aWRlZCBhcyBmaXJzdCBhcmd1bWVudFxuICAgICAgYWxsSGFuZGxlcnMucHVzaChtZXRob2ROYW1lKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZE5hbWUgaW4gbWV0aG9kT2JqKSB7XG4gICAgICAvLyBWYWxpZCBTdHJpbmcgZXZlbnQgcHJvdmlkZWRcbiAgICAgIG1ldGhvZE9ialttZXRob2ROYW1lXS5oYW5kbGVycy5wdXNoKGNhbGxiYWNrKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gQWN0dWFsbHkgZXhwb3NlIGFuIGludGVyZmFjZVxuICB3LkNvbnNvbGVMaXN0ZW5lciA9IHtcbiAgICBvbjogY29uc29sZU9uXG4gIH07XG59KHRoaXMpKTtcblxuLyoqXG4gKiBNYXAgUGlja2VyXG4gKi9cbnZhciB3b29ncmFiZXhwcmVzc01hcFBpY2tlciA9IHtcblx0cGFyYW1zOiB7fSxcblx0b3JpZ2luX2xhdDogJycsXG5cdG9yaWdpbl9sbmc6ICcnLFxuXHRvcmlnaW5fYWRkcmVzczogJycsXG5cdHpvb21MZXZlbDogMTYsXG5cdGFwaUtleUVycm9yQ2hlY2tJbnRlcnZhbDogbnVsbCxcblx0YXBpS2V5RXJyb3I6ICcnLFxuXHRlZGl0aW5nQVBJS2V5OiBmYWxzZSxcblx0aW5pdDogZnVuY3Rpb24gKHBhcmFtcykge1xuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnBhcmFtcyA9IHBhcmFtcztcblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5hcGlLZXlFcnJvciA9ICcnO1xuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmVkaXRpbmdBUElLZXkgPSBmYWxzZTtcblxuXHRcdENvbnNvbGVMaXN0ZW5lci5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyb3JNZXNzYWdlKSB7XG5cdFx0XHRpZiAoZXJyb3JNZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignZ29vZ2xlJykgIT09IC0xKSB7XG5cdFx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmFwaUtleUVycm9yID0gZXJyb3JNZXNzYWdlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoJCgnLmdtLWVyci1tZXNzYWdlJykubGVuZ3RoKSB7XG5cdFx0XHRcdCQoJy5nbS1lcnItbWVzc2FnZScpLnJlcGxhY2VXaXRoKCc8cCBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyXCI+JyArIHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmNvbnZlcnRFcnJvcihlcnJvck1lc3NhZ2UpICsgJzwvcD4nKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdCQoJ1tkYXRhLWxpbms9XCJhcGlfa2V5XCJdJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHQkKHRoaXMpLmFmdGVyKHdwLnRlbXBsYXRlKCd3b29ncmFiZXhwcmVzcy1idXR0b24nKSh7XG5cdFx0XHRcdGhyZWY6ICcjJyxcblx0XHRcdFx0Y2xhc3M6ICd3b29ncmFiZXhwcmVzcy1idXR0b25zLS1oYXMtaWNvbiB3b29ncmFiZXhwcmVzcy1hcGkta2V5LWJ1dHRvbicsXG5cdFx0XHRcdHRleHQ6ICc8c3BhbiBjbGFzcz1cImRhc2hpY29uc1wiPjwvc3Bhbj4nLFxuXHRcdFx0fSkpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRWRpdCBBcGkgS2V5XG5cdFx0JChkb2N1bWVudCkub2ZmKCdmb2N1cycsICdbZGF0YS1saW5rPVwiYXBpX2tleVwiXScpO1xuXHRcdCQoZG9jdW1lbnQpLm9uKCdmb2N1cycsICdbZGF0YS1saW5rPVwiYXBpX2tleVwiXScsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGlmICgkKHRoaXMpLnByb3AoJ3JlYWRvbmx5JykgJiYgISQodGhpcykuaGFzQ2xhc3MoJ2xvYWRpbmcnKSkge1xuXHRcdFx0XHQkKHRoaXMpLmRhdGEoJ3ZhbHVlJywgJCh0aGlzKS52YWwoKSkucHJvcCgncmVhZG9ubHknLCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQkKGRvY3VtZW50KS5vZmYoJ2JsdXInLCAnW2RhdGEtbGluaz1cImFwaV9rZXlcIl0nKTtcblx0XHQkKGRvY3VtZW50KS5vbignYmx1cicsICdbZGF0YS1saW5rPVwiYXBpX2tleVwiXScsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGlmICghJCh0aGlzKS5wcm9wKCdyZWFkb25seScpICYmICEkKHRoaXMpLmhhc0NsYXNzKCdlZGl0aW5nJykpIHtcblx0XHRcdFx0JCh0aGlzKS5kYXRhKCd2YWx1ZScsIHVuZGVmaW5lZCkucHJvcCgncmVhZG9ubHknLCB0cnVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdCQoZG9jdW1lbnQpLm9mZignaW5wdXQnLCAnW2RhdGEtbGluaz1cImFwaV9rZXlcIl0nLCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5oYW5kbGVBcGlLZXlJbnB1dCk7XG5cdFx0JChkb2N1bWVudCkub24oJ2lucHV0JywgJ1tkYXRhLWxpbms9XCJhcGlfa2V5XCJdJywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuaGFuZGxlQXBpS2V5SW5wdXQpO1xuXG5cdFx0Ly8gRWRpdCBBcGkgS2V5XG5cdFx0JChkb2N1bWVudCkub2ZmKCdjbGljaycsICcud29vZ3JhYmV4cHJlc3MtYXBpLWtleS1idXR0b24nLCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5lZGl0QXBpS2V5KTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLndvb2dyYWJleHByZXNzLWFwaS1rZXktYnV0dG9uJywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuZWRpdEFwaUtleSk7XG5cblx0XHQvLyBTaG93IFN0b3JlIExvY2F0aW9uIFBpY2tlclxuXHRcdCQoZG9jdW1lbnQpLm9mZignY2xpY2snLCAnLndvb2dyYWJleHByZXNzLWZpZWxkLS1vcmlnaW4nKTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLndvb2dyYWJleHByZXNzLWZpZWxkLS1vcmlnaW4nLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRpZiAoJCh0aGlzKS5wcm9wKCdyZWFkb25seScpKSB7XG5cdFx0XHRcdCQoJy53b29ncmFiZXhwcmVzcy1lZGl0LWxvY2F0aW9uLXBpY2tlcicpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBTaG93IFN0b3JlIExvY2F0aW9uIFBpY2tlclxuXHRcdCQoZG9jdW1lbnQpLm9mZignZm9jdXMnLCAnW2RhdGEtbGluaz1cImxvY2F0aW9uX3BpY2tlclwiXScsIHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnNob3dMb2NhdGlvblBpY2tlcik7XG5cdFx0JChkb2N1bWVudCkub24oJ2ZvY3VzJywgJ1tkYXRhLWxpbms9XCJsb2NhdGlvbl9waWNrZXJcIl0nLCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5zaG93TG9jYXRpb25QaWNrZXIpO1xuXG5cdFx0Ly8gSGlkZSBTdG9yZSBMb2NhdGlvbiBQaWNrZXJcblx0XHQkKGRvY3VtZW50KS5vZmYoJ2NsaWNrJywgJyN3b29ncmFiZXhwcmVzcy1idG4tLW1hcC1jYW5jZWwnLCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5oaWRlTG9jYXRpb25QaWNrZXIpO1xuXHRcdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjd29vZ3JhYmV4cHJlc3MtYnRuLS1tYXAtY2FuY2VsJywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuaGlkZUxvY2F0aW9uUGlja2VyKTtcblxuXHRcdC8vIEFwcGx5IFN0b3JlIExvY2F0aW9uXG5cdFx0JChkb2N1bWVudCkub2ZmKCdjbGljaycsICcjd29vZ3JhYmV4cHJlc3MtYnRuLS1tYXAtYXBwbHknLCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5hcHBseUxvY2F0aW9uUGlja2VyKTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3dvb2dyYWJleHByZXNzLWJ0bi0tbWFwLWFwcGx5Jywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuYXBwbHlMb2NhdGlvblBpY2tlcik7XG5cblx0XHQvLyBUb2dnbGUgTWFwIFNlYXJjaCBQYW5lbFxuXHRcdCQoZG9jdW1lbnQpLm9mZignY2xpY2snLCAnI3dvb2dyYWJleHByZXNzLW1hcC1zZWFyY2gtcGFuZWwtdG9nZ2xlJywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIudG9nZ2xlTWFwU2VhcmNoKTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3dvb2dyYWJleHByZXNzLW1hcC1zZWFyY2gtcGFuZWwtdG9nZ2xlJywgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIudG9nZ2xlTWFwU2VhcmNoKTtcblx0fSxcblx0dmFsaWRhdGVBUElLZXlCb3RoU2lkZTogZnVuY3Rpb24gKCRpbnB1dCkge1xuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnZhbGlkYXRlQVBJS2V5U2VydmVyU2lkZSgkaW5wdXQsIHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnZhbGlkYXRlQVBJS2V5QnJvd3NlclNpZGUpO1xuXHR9LFxuXHR2YWxpZGF0ZUFQSUtleUJyb3dzZXJTaWRlOiBmdW5jdGlvbiAoJGlucHV0KSB7XG5cdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuYXBpS2V5RXJyb3IgPSAnJztcblxuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmluaXRNYXAoJGlucHV0LnZhbCgpLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgZ2VvY29kZXJBcmdzID0ge1xuXHRcdFx0XHRsYXRMbmc6IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocGFyc2VGbG9hdCh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5wYXJhbXMuZGVmYXVsdExhdCksIHBhcnNlRmxvYXQod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIucGFyYW1zLmRlZmF1bHRMbmcpKSxcblx0XHRcdH07XG5cblx0XHRcdHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXG5cdFx0XHRnZW9jb2Rlci5nZW9jb2RlKGdlb2NvZGVyQXJncywgZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykge1xuXHRcdFx0XHRpZiAoc3RhdHVzLnRvTG93ZXJDYXNlKCkgPT09ICdvaycpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygndmFsaWRhdGVBUElLZXlCcm93c2VyU2lkZScsIHJlc3VsdHMpO1xuXG5cdFx0XHRcdFx0JGlucHV0LmFkZENsYXNzKCd2YWxpZCcpO1xuXG5cdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHQkaW5wdXQucmVtb3ZlQ2xhc3MoJ2VkaXRpbmcgbG9hZGluZyB2YWxpZCcpO1xuXHRcdFx0XHRcdH0sIDIwMDApO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Y2xlYXJJbnRlcnZhbCh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5hcGlLZXlFcnJvckNoZWNrSW50ZXJ2YWwpO1xuXG5cdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5hcGlLZXlFcnJvckNoZWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGlmICgkaW5wdXQuaGFzQ2xhc3MoJ3ZhbGlkJykgfHwgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuYXBpS2V5RXJyb3IpIHtcblx0XHRcdFx0XHRjbGVhckludGVydmFsKHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmFwaUtleUVycm9yQ2hlY2tJbnRlcnZhbCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuYXBpS2V5RXJyb3IpIHtcblx0XHRcdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5zaG93RXJyb3IoJGlucHV0LCB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5hcGlLZXlFcnJvcik7XG5cdFx0XHRcdFx0JGlucHV0LnByb3AoJ3JlYWRvbmx5JywgZmFsc2UpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDMwMCk7XG5cdFx0fSk7XG5cdH0sXG5cdHZhbGlkYXRlQVBJS2V5U2VydmVyU2lkZTogZnVuY3Rpb24gKCRpbnB1dCwgb25TdWNjZXNzKSB7XG5cdFx0JC5hamF4KHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0dXJsOiB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5wYXJhbXMuYWpheF91cmwsXG5cdFx0XHRkYXRhOiB7XG5cdFx0XHRcdGFjdGlvbjogJ3dvb2dyYWJleHByZXNzX3ZhbGlkYXRlX2FwaV9rZXlfc2VydmVyJyxcblx0XHRcdFx0bm9uY2U6IHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnBhcmFtcy52YWxpZGF0ZV9hcGlfa2V5X25vbmNlLFxuXHRcdFx0XHRrZXk6ICRpbnB1dC52YWwoKSxcblx0XHRcdH1cblx0XHR9KS5kb25lKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ3ZhbGlkYXRlQVBJS2V5U2VydmVyU2lkZScsIHJlc3BvbnNlKTtcblxuXHRcdFx0aWYgKHR5cGVvZiBvblN1Y2Nlc3MgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0b25TdWNjZXNzKCRpbnB1dCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkaW5wdXQuYWRkQ2xhc3MoJ3ZhbGlkJyk7XG5cblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0JGlucHV0LnJlbW92ZUNsYXNzKCdlZGl0aW5nIGxvYWRpbmcgdmFsaWQnKTtcblx0XHRcdFx0fSwgMjAwMCk7XG5cdFx0XHR9XG5cdFx0fSkuZmFpbChmdW5jdGlvbiAoZXJyb3IpIHtcblx0XHRcdGlmIChlcnJvci5yZXNwb25zZUpTT04gJiYgZXJyb3IucmVzcG9uc2VKU09OLmRhdGEpIHtcblx0XHRcdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuc2hvd0Vycm9yKCRpbnB1dCwgZXJyb3IucmVzcG9uc2VKU09OLmRhdGEpO1xuXHRcdFx0fSBlbHNlIGlmIChlcnJvci5zdGF0dXNUZXh0KSB7XG5cdFx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnNob3dFcnJvcigkaW5wdXQsIGVycm9yLnN0YXR1c1RleHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuc2hvd0Vycm9yKCRpbnB1dCwgJ0dvb2dsZSBEaXN0YW5jZSBNYXRyaXggQVBJIGVycm9yOiBVa25vd24nKTtcblx0XHRcdH1cblxuXHRcdFx0JGlucHV0LnByb3AoJ3JlYWRvbmx5JywgZmFsc2UpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG5cdFx0fSk7XG5cdH0sXG5cdHNob3dFcnJvcjogZnVuY3Rpb24gKCRpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XG5cdFx0JCgnPGRpdiBjbGFzcz1cImVycm9yIG5vdGljZSB3b29ncmFiZXhwcmVzcy1lcnJvci1ib3hcIj48cD4nICsgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuY29udmVydEVycm9yKGVycm9yTWVzc2FnZSkgKyAnPC9wPjwvZGl2PicpXG5cdFx0XHQuaGlkZSgpXG5cdFx0XHQuYXBwZW5kVG8oJGlucHV0LmNsb3Nlc3QoJ3RkJykpXG5cdFx0XHQuc2xpZGVEb3duKCk7XG5cdH0sXG5cdHJlbW92ZUVycm9yOiBmdW5jdGlvbiAoJGlucHV0KSB7XG5cdFx0JGlucHV0LmNsb3Nlc3QoJ3RkJylcblx0XHRcdC5maW5kKCcud29vZ3JhYmV4cHJlc3MtZXJyb3ItYm94Jylcblx0XHRcdC5yZW1vdmUoKTtcblx0fSxcblx0Y29udmVydEVycm9yOiBmdW5jdGlvbiAodGV4dCkge1xuXHRcdHZhciBleHAgPSAvKFxcYihodHRwcz98ZnRwfGZpbGUpOlxcL1xcL1stQS1aMC05KyZAI1xcLyU/PX5ffCE6LC47XSpbLUEtWjAtOSsmQCNcXC8lPX5ffF0pL2lnO1xuXHRcdHJldHVybiB0ZXh0LnJlcGxhY2UoZXhwLCBcIjxhIGhyZWY9JyQxJyB0YXJnZXQ9J19ibGFuayc+JDE8L2E+XCIpO1xuXHR9LFxuXHRoYW5kbGVBcGlLZXlJbnB1dDogZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgJGlucHV0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuXG5cdFx0aWYgKCRpbnB1dC52YWwoKSA9PT0gJGlucHV0LmRhdGEoJ3ZhbHVlJykpIHtcblx0XHRcdCRpbnB1dC5yZW1vdmVDbGFzcygnZWRpdGluZycpLm5leHQoJy53b29ncmFiZXhwcmVzcy1lZGl0LWFwaS1rZXknKS5yZW1vdmVDbGFzcygnZWRpdGluZycpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkaW5wdXQuYWRkQ2xhc3MoJ2VkaXRpbmcnKS5uZXh0KCcud29vZ3JhYmV4cHJlc3MtZWRpdC1hcGkta2V5JykuYWRkQ2xhc3MoJ2VkaXRpbmcnKTtcblx0XHR9XG5cblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5yZW1vdmVFcnJvcigkaW5wdXQpO1xuXHR9LFxuXHRlZGl0QXBpS2V5OiBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciAkaW5wdXQgPSAkKHRoaXMpLmJsdXIoKS5wcmV2KCdpbnB1dCcpO1xuXG5cdFx0aWYgKCEkaW5wdXQuaGFzQ2xhc3MoJ2VkaXRpbmcnKSB8fCAkaW5wdXQuaGFzQ2xhc3MoJ2xvYWRpbmcnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdCRpbnB1dC5wcm9wKCdyZWFkb25seScsIHRydWUpLmFkZENsYXNzKCdsb2FkaW5nJyk7XG5cblx0XHRpZiAoJGlucHV0LmF0dHIoJ2RhdGEta2V5JykgPT09ICdhcGlfa2V5Jykge1xuXHRcdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIudmFsaWRhdGVBUElLZXlTZXJ2ZXJTaWRlKCRpbnB1dCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnZhbGlkYXRlQVBJS2V5QnJvd3NlclNpZGUoJGlucHV0KTtcblx0XHR9XG5cblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5yZW1vdmVFcnJvcigkaW5wdXQpO1xuXHR9LFxuXHRzaG93TG9jYXRpb25QaWNrZXI6IGZ1bmN0aW9uIChldmVudCkge1xuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQkKHRoaXMpLmJsdXIoKTtcblxuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmFwaUtleUVycm9yID0gJyc7XG5cblx0XHR2YXIgYXBpX2tleV9waWNrZXIgPSAkKCcjd29vY29tbWVyY2Vfd29vZ3JhYmV4cHJlc3NfYXBpX2tleV9waWNrZXInKS52YWwoKTtcblxuXHRcdGlmICh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5pc0VkaXRpbmdBUElLZXkoKSkge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5hbGVydCh3b29ncmFiZXhwcmVzc0Vycm9yKCdmaW5pc2hfZWRpdGluZ19hcGknKSk7XG5cdFx0fSBlbHNlIGlmICghYXBpX2tleV9waWNrZXIubGVuZ3RoKSB7XG5cdFx0XHRyZXR1cm4gd2luZG93LmFsZXJ0KHdvb2dyYWJleHByZXNzRXJyb3IoJ2FwaV9rZXlfcGlja2VyX2VtcHR5JykpO1xuXHRcdH1cblxuXHRcdCQoJy5tb2RhbC1jbG9zZS1saW5rJykuaGlkZSgpO1xuXG5cdFx0d29vZ3JhYmV4cHJlc3NUb2dnbGVCdXR0b25zKHtcblx0XHRcdGJ0bl9sZWZ0OiB7XG5cdFx0XHRcdGlkOiAnbWFwLWNhbmNlbCcsXG5cdFx0XHRcdGxhYmVsOiB3b29ncmFiZXhwcmVzc0kxOG4oJ2J1dHRvbnMuQ2FuY2VsJyksXG5cdFx0XHRcdGljb246ICd1bmRvJ1xuXHRcdFx0fSxcblx0XHRcdGJ0bl9yaWdodDoge1xuXHRcdFx0XHRpZDogJ21hcC1hcHBseScsXG5cdFx0XHRcdGxhYmVsOiB3b29ncmFiZXhwcmVzc0kxOG4oJ2J1dHRvbnMuQXBwbHkgQ2hhbmdlcycpLFxuXHRcdFx0XHRpY29uOiAnZWRpdG9yLXNwZWxsY2hlY2snXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtd3JhcC0tbG9jYXRpb25fcGlja2VyJykuZmFkZUluKCkuc2libGluZ3MoKS5oaWRlKCk7XG5cblx0XHR2YXIgJHN1YlRpdGxlID0gJCgnI3dvb2dyYWJleHByZXNzLWZpZWxkLWdyb3VwLXdyYXAtLWxvY2F0aW9uX3BpY2tlcicpLmZpbmQoJy53Yy1zZXR0aW5ncy1zdWItdGl0bGUnKS5maXJzdCgpLmFkZENsYXNzKCd3b29ncmFiZXhwcmVzcy1oaWRkZW4nKTtcblxuXHRcdCQoJy53Yy1iYWNrYm9uZS1tb2RhbC1oZWFkZXInKS5maW5kKCdoMScpLmFwcGVuZCgnPHNwYW4+JyArICRzdWJUaXRsZS50ZXh0KCkgKyAnPC9zcGFuPicpO1xuXG5cdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuaW5pdE1hcChhcGlfa2V5X3BpY2tlciwgd29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIucmVuZGVyTWFwKTtcblx0fSxcblx0aGlkZUxvY2F0aW9uUGlja2VyOiBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmRlc3Ryb3lNYXAoKTtcblxuXHRcdCQoJy5tb2RhbC1jbG9zZS1saW5rJykuc2hvdygpO1xuXG5cdFx0d29vZ3JhYmV4cHJlc3NUb2dnbGVCdXR0b25zKCk7XG5cblx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtd3JhcC0tbG9jYXRpb25fcGlja2VyJykuZmluZCgnLndjLXNldHRpbmdzLXN1Yi10aXRsZScpLmZpcnN0KCkucmVtb3ZlQ2xhc3MoJ3dvb2dyYWJleHByZXNzLWhpZGRlbicpO1xuXG5cdFx0JCgnLndjLWJhY2tib25lLW1vZGFsLWhlYWRlcicpLmZpbmQoJ2gxIHNwYW4nKS5yZW1vdmUoKTtcblxuXHRcdCQoJyN3b29ncmFiZXhwcmVzcy1maWVsZC1ncm91cC13cmFwLS1sb2NhdGlvbl9waWNrZXInKS5oaWRlKCkuc2libGluZ3MoKS5ub3QoJy53b29ncmFiZXhwcmVzcy1oaWRkZW4nKS5mYWRlSW4oKTtcblx0fSxcblx0YXBwbHlMb2NhdGlvblBpY2tlcjogZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAoIXdvb2dyYWJleHByZXNzTWFwUGlja2VyLmFwaUtleUVycm9yKSB7XG5cdFx0XHQkKCcjd29vY29tbWVyY2Vfd29vZ3JhYmV4cHJlc3Nfb3JpZ2luX2xhdCcpLnZhbCh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbGF0KTtcblx0XHRcdCQoJyN3b29jb21tZXJjZV93b29ncmFiZXhwcmVzc19vcmlnaW5fbG5nJykudmFsKHdvb2dyYWJleHByZXNzTWFwUGlja2VyLm9yaWdpbl9sbmcpO1xuXHRcdFx0JCgnI3dvb2NvbW1lcmNlX3dvb2dyYWJleHByZXNzX29yaWdpbl9hZGRyZXNzJykudmFsKHdvb2dyYWJleHByZXNzTWFwUGlja2VyLm9yaWdpbl9hZGRyZXNzKTtcblx0XHR9XG5cblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5oaWRlTG9jYXRpb25QaWNrZXIoZSk7XG5cdH0sXG5cdHRvZ2dsZU1hcFNlYXJjaDogZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtbWFwLXNlYXJjaC1wYW5lbCcpLnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuXHR9LFxuXHRpbml0TWFwOiBmdW5jdGlvbiAoYXBpS2V5LCBjYWxsYmFjaykge1xuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmRlc3Ryb3lNYXAoKTtcblxuXHRcdGlmIChfLmlzRW1wdHkoYXBpS2V5KSkge1xuXHRcdFx0YXBpS2V5ID0gJ0ludmFsaWRLZXknO1xuXHRcdH1cblxuXHRcdCQuZ2V0U2NyaXB0KCdodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvanM/bGlicmFyaWVzPWdlb21ldHJ5LHBsYWNlcyZrZXk9JyArIGFwaUtleSwgY2FsbGJhY2spO1xuXHR9LFxuXHRyZW5kZXJNYXA6IGZ1bmN0aW9uICgpIHtcblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbGF0ID0gJCgnI3dvb2NvbW1lcmNlX3dvb2dyYWJleHByZXNzX29yaWdpbl9sYXQnKS52YWwoKTtcblx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbG5nID0gJCgnI3dvb2NvbW1lcmNlX3dvb2dyYWJleHByZXNzX29yaWdpbl9sbmcnKS52YWwoKTtcblxuXHRcdHZhciBjdXJyZW50TGF0TG5nID0ge1xuXHRcdFx0bGF0OiBfLmlzRW1wdHkod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIub3JpZ2luX2xhdCkgPyBwYXJzZUZsb2F0KHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnBhcmFtcy5kZWZhdWx0TGF0KSA6IHBhcnNlRmxvYXQod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIub3JpZ2luX2xhdCksXG5cdFx0XHRsbmc6IF8uaXNFbXB0eSh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbG5nKSA/IHBhcnNlRmxvYXQod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIucGFyYW1zLmRlZmF1bHRMbmcpIDogcGFyc2VGbG9hdCh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbG5nKVxuXHRcdH07XG5cblx0XHR2YXIgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3b29ncmFiZXhwcmVzcy1tYXAtY2FudmFzJyksXG5cdFx0XHR7XG5cdFx0XHRcdG1hcFR5cGVJZDogJ3JvYWRtYXAnLFxuXHRcdFx0XHRjZW50ZXI6IGN1cnJlbnRMYXRMbmcsXG5cdFx0XHRcdHpvb206IHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnpvb21MZXZlbCxcblx0XHRcdFx0c3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuXHRcdFx0XHRtYXBUeXBlQ29udHJvbDogZmFsc2Vcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0dmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuXHRcdFx0bWFwOiBtYXAsXG5cdFx0XHRwb3NpdGlvbjogY3VycmVudExhdExuZyxcblx0XHRcdGRyYWdnYWJsZTogdHJ1ZSxcblx0XHRcdGljb246IHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnBhcmFtcy5tYXJrZXJcblx0XHR9KTtcblxuXHRcdHZhciBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coeyBtYXhXaWR0aDogMzUwIH0pO1xuXG5cdFx0aWYgKF8uaXNFbXB0eSh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbGF0KSB8fCBfLmlzRW1wdHkod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIub3JpZ2luX2xuZykpIHtcblx0XHRcdGluZm93aW5kb3cuc2V0Q29udGVudCh3b29ncmFiZXhwcmVzc01hcFBpY2tlci5wYXJhbXMuaTE4bi5kcmFnX21hcmtlcik7XG5cdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5zZXRMYXRMbmcobWFya2VyLnBvc2l0aW9uLCBtYXJrZXIsIG1hcCwgaW5mb3dpbmRvdyk7XG5cdFx0fVxuXG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnZHJhZ3N0YXJ0JywgZnVuY3Rpb24gKCkge1xuXHRcdFx0aW5mb3dpbmRvdy5jbG9zZSgpO1xuXHRcdH0pO1xuXG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuc2V0TGF0TG5nKGV2ZW50LmxhdExuZywgbWFya2VyLCBtYXAsIGluZm93aW5kb3cpO1xuXHRcdH0pO1xuXG5cdFx0JCgnI3dvb2dyYWJleHByZXNzLW1hcC13cmFwJykucHJlcGVuZCh3cC50ZW1wbGF0ZSgnd29vZ3JhYmV4cHJlc3MtbWFwLXNlYXJjaC1wYW5lbCcpKCkpO1xuXHRcdG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvb2dyYWJleHByZXNzLW1hcC1zZWFyY2gtcGFuZWwnKSk7XG5cblx0XHR2YXIgbWFwU2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvb2dyYWJleHByZXNzLW1hcC1zZWFyY2gtaW5wdXQnKSk7XG5cblx0XHQvLyBCaWFzIHRoZSBTZWFyY2hCb3ggcmVzdWx0cyB0b3dhcmRzIGN1cnJlbnQgbWFwJ3Mgdmlld3BvcnQuXG5cdFx0bWFwLmFkZExpc3RlbmVyKCdib3VuZHNfY2hhbmdlZCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdG1hcFNlYXJjaEJveC5zZXRCb3VuZHMobWFwLmdldEJvdW5kcygpKTtcblx0XHR9KTtcblxuXHRcdHZhciBtYXJrZXJzID0gW107XG5cblx0XHQvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYSBwcmVkaWN0aW9uIGFuZCByZXRyaWV2ZSBtb3JlIGRldGFpbHMgZm9yIHRoYXQgcGxhY2UuXG5cdFx0bWFwU2VhcmNoQm94LmFkZExpc3RlbmVyKCdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBwbGFjZXMgPSBtYXBTZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cblx0XHRcdGlmIChwbGFjZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2xlYXIgb3V0IHRoZSBvbGQgbWFya2Vycy5cblx0XHRcdG1hcmtlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFya2VyKSB7XG5cdFx0XHRcdG1hcmtlci5zZXRNYXAobnVsbCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0bWFya2VycyA9IFtdO1xuXG5cdFx0XHQvLyBGb3IgZWFjaCBwbGFjZSwgZ2V0IHRoZSBpY29uLCBuYW1lIGFuZCBsb2NhdGlvbi5cblx0XHRcdHZhciBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG5cblx0XHRcdHBsYWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChwbGFjZSkge1xuXHRcdFx0XHRpZiAoIXBsYWNlLmdlb21ldHJ5KSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ1JldHVybmVkIHBsYWNlIGNvbnRhaW5zIG5vIGdlb21ldHJ5Jyk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG5cdFx0XHRcdFx0bWFwOiBtYXAsXG5cdFx0XHRcdFx0cG9zaXRpb246IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLFxuXHRcdFx0XHRcdGRyYWdnYWJsZTogdHJ1ZSxcblx0XHRcdFx0XHRpY29uOiB3b29ncmFiZXhwcmVzc01hcFBpY2tlci5wYXJhbXMubWFya2VyXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnNldExhdExuZyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbiwgbWFya2VyLCBtYXAsIGluZm93aW5kb3cpO1xuXG5cdFx0XHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2RyYWdzdGFydCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpbmZvd2luZG93LmNsb3NlKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2RyYWdlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5zZXRMYXRMbmcoZXZlbnQubGF0TG5nLCBtYXJrZXIsIG1hcCwgaW5mb3dpbmRvdyk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIENyZWF0ZSBhIG1hcmtlciBmb3IgZWFjaCBwbGFjZS5cblx0XHRcdFx0bWFya2Vycy5wdXNoKG1hcmtlcik7XG5cblx0XHRcdFx0aWYgKHBsYWNlLmdlb21ldHJ5LnZpZXdwb3J0KSB7XG5cdFx0XHRcdFx0Ly8gT25seSBnZW9jb2RlcyBoYXZlIHZpZXdwb3J0LlxuXHRcdFx0XHRcdGJvdW5kcy51bmlvbihwbGFjZS5nZW9tZXRyeS52aWV3cG9ydCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ym91bmRzLmV4dGVuZChwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRtYXAuZml0Qm91bmRzKGJvdW5kcyk7XG5cdFx0fSk7XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdCQoJyN3b29ncmFiZXhwcmVzcy1tYXAtc2VhcmNoLXBhbmVsJykucmVtb3ZlQ2xhc3MoJ3dvb2dyYWJleHByZXNzLWhpZGRlbicpO1xuXHRcdH0sIDUwMCk7XG5cdH0sXG5cdGRlc3Ryb3lNYXA6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAod2luZG93Lmdvb2dsZSkge1xuXHRcdFx0d2luZG93Lmdvb2dsZSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cblx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtbWFwLWNhbnZhcycpLmVtcHR5KCk7XG5cdFx0JCgnI3dvb2dyYWJleHByZXNzLW1hcC1zZWFyY2gtcGFuZWwnKS5yZW1vdmUoKTtcblx0fSxcblx0c2V0TGF0TG5nOiBmdW5jdGlvbiAobG9jYXRpb24sIG1hcmtlciwgbWFwLCBpbmZvd2luZG93KSB7XG5cdFx0dmFyIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG5cblx0XHRnZW9jb2Rlci5nZW9jb2RlKFxuXHRcdFx0e1xuXHRcdFx0XHRsYXRMbmc6IGxvY2F0aW9uXG5cdFx0XHR9LFxuXHRcdFx0ZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykge1xuXHRcdFx0XHRpZiAoc3RhdHVzID09PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSyAmJiByZXN1bHRzWzBdKSB7XG5cdFx0XHRcdFx0dmFyIGluZm93aW5kb3dDb250ZW50cyA9IFtcblx0XHRcdFx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLnBhcmFtcy5pMThuLmxhdGl0dWRlICsgJzogJyArIGxvY2F0aW9uLmxhdCgpLnRvU3RyaW5nKCksXG5cdFx0XHRcdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5wYXJhbXMuaTE4bi5sb25naXR1ZGUgKyAnOiAnICsgbG9jYXRpb24ubG5nKCkudG9TdHJpbmcoKVxuXHRcdFx0XHRcdF07XG5cblx0XHRcdFx0XHRpbmZvd2luZG93LnNldENvbnRlbnQoaW5mb3dpbmRvd0NvbnRlbnRzLmpvaW4oJzxiciAvPicpKTtcblx0XHRcdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xuXG5cdFx0XHRcdFx0bWFya2VyLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGluZm93aW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtbWFwLXNlYXJjaC1pbnB1dCcpLnZhbChyZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzKTtcblxuXHRcdFx0XHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLm9yaWdpbl9sYXQgPSBsb2NhdGlvbi5sYXQoKTtcblx0XHRcdFx0XHR3b29ncmFiZXhwcmVzc01hcFBpY2tlci5vcmlnaW5fbG5nID0gbG9jYXRpb24ubG5nKCk7XG5cdFx0XHRcdFx0d29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIub3JpZ2luX2FkZHJlc3MgPSByZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdG1hcC5zZXRDZW50ZXIobG9jYXRpb24pO1xuXHR9LFxuXHRpc0VkaXRpbmdBUElLZXk6IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gJCgnW2RhdGEtbGluaz1cImFwaV9rZXlcIl0uZWRpdGluZycpLmxlbmd0aCA+IDA7XG5cdH0sXG59O1xuXG4vKipcbiAqIEJhY2tlbmQgU2NyaXB0c1xuICovXG5cbnZhciB3b29ncmFiZXhwcmVzc0JhY2tlbmQgPSB7XG5cdHJlbmRlckZvcm06IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoISQoJyN3b29jb21tZXJjZV93b29ncmFiZXhwcmVzc19vcmlnaW5fdHlwZScpIHx8ICEkKCcjd29vY29tbWVyY2Vfd29vZ3JhYmV4cHJlc3Nfb3JpZ2luX3R5cGUnKS5sZW5ndGgpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBTdWJtaXQgZm9ybVxuXHRcdCQoZG9jdW1lbnQpLm9mZignY2xpY2snLCAnI3dvb2dyYWJleHByZXNzLWJ0bi0tc2F2ZS1zZXR0aW5ncycsIHdvb2dyYWJleHByZXNzQmFja2VuZC5zdWJtaXRGb3JtKTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3dvb2dyYWJleHByZXNzLWJ0bi0tc2F2ZS1zZXR0aW5ncycsIHdvb2dyYWJleHByZXNzQmFja2VuZC5zdWJtaXRGb3JtKTtcblxuXHRcdC8vIFRvZ2dsZSBTdG9yZSBPcmlnaW4gRmllbGRzXG5cdFx0JChkb2N1bWVudCkub2ZmKCdjaGFuZ2UnLCAnI3dvb2NvbW1lcmNlX3dvb2dyYWJleHByZXNzX29yaWdpbl90eXBlJywgd29vZ3JhYmV4cHJlc3NCYWNrZW5kLnRvZ2dsZVN0b3JlT3JpZ2luRmllbGRzKTtcblx0XHQkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJyN3b29jb21tZXJjZV93b29ncmFiZXhwcmVzc19vcmlnaW5fdHlwZScsIHdvb2dyYWJleHByZXNzQmFja2VuZC50b2dnbGVTdG9yZU9yaWdpbkZpZWxkcyk7XG5cblx0XHQkKCcjd29vY29tbWVyY2Vfd29vZ3JhYmV4cHJlc3Nfb3JpZ2luX3R5cGUnKS50cmlnZ2VyKCdjaGFuZ2UnKTtcblxuXHRcdCQoJy53Yy1tb2RhbC1zaGlwcGluZy1tZXRob2Qtc2V0dGluZ3MgdGFibGUuZm9ybS10YWJsZScpLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyICR0YWJsZSA9ICQodGhpcyk7XG5cdFx0XHR2YXIgJHJvd3MgPSAkdGFibGUuZmluZCgndHInKTtcblxuXHRcdFx0aWYgKCEkcm93cy5sZW5ndGgpIHtcblx0XHRcdFx0JHRhYmxlLnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0JCgnLndvb2dyYWJleHByZXNzLWZpZWxkLWdyb3VwJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgJGZpZWxkR3JvdXAgPSAkKHRoaXMpO1xuXG5cdFx0XHR2YXIgZmllbGRHcm91cElkID0gJGZpZWxkR3JvdXBcblx0XHRcdFx0LmF0dHIoJ2lkJylcblx0XHRcdFx0LnJlcGxhY2UoJ3dvb2NvbW1lcmNlX3dvb2dyYWJleHByZXNzX2ZpZWxkX2dyb3VwXycsICcnKTtcblxuXHRcdFx0dmFyICRmaWVsZEdyb3VwRGVzY3JpcHRpb24gPSAkZmllbGRHcm91cFxuXHRcdFx0XHQubmV4dCgncCcpXG5cdFx0XHRcdC5kZXRhY2goKTtcblxuXHRcdFx0dmFyICRmaWVsZEdyb3VwVGFibGUgPSAkZmllbGRHcm91cFxuXHRcdFx0XHQubmV4dEFsbCgndGFibGUuZm9ybS10YWJsZScpXG5cdFx0XHRcdC5maXJzdCgpXG5cdFx0XHRcdC5hdHRyKCdpZCcsICd3b29ncmFiZXhwcmVzcy10YWJsZS0tJyArIGZpZWxkR3JvdXBJZClcblx0XHRcdFx0LmFkZENsYXNzKCd3b29ncmFiZXhwcmVzcy10YWJsZSB3b29ncmFiZXhwcmVzcy10YWJsZS0tJyArIGZpZWxkR3JvdXBJZClcblx0XHRcdFx0LmRldGFjaCgpO1xuXG5cdFx0XHQkZmllbGRHcm91cFxuXHRcdFx0XHQud3JhcCgnPGRpdiBpZD1cIndvb2dyYWJleHByZXNzLWZpZWxkLWdyb3VwLXdyYXAtLScgKyBmaWVsZEdyb3VwSWQgKyAnXCIgY2xhc3M9XCJ3b29ncmFiZXhwcmVzcy1maWVsZC1ncm91cC13cmFwIHN0dWZmYm94IHdvb2dyYWJleHByZXNzLWZpZWxkLWdyb3VwLXdyYXAtLScgKyBmaWVsZEdyb3VwSWQgKyAnXCI+PC9kaXY+Jyk7XG5cblx0XHRcdCRmaWVsZEdyb3VwRGVzY3JpcHRpb25cblx0XHRcdFx0LmFwcGVuZFRvKCcjd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtd3JhcC0tJyArIGZpZWxkR3JvdXBJZCk7XG5cblx0XHRcdCRmaWVsZEdyb3VwVGFibGVcblx0XHRcdFx0LmFwcGVuZFRvKCcjd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtd3JhcC0tJyArIGZpZWxkR3JvdXBJZCk7XG5cblx0XHRcdGlmICgkZmllbGRHcm91cFRhYmxlICYmICRmaWVsZEdyb3VwVGFibGUubGVuZ3RoKSB7XG5cdFx0XHRcdGlmICgkZmllbGRHcm91cC5oYXNDbGFzcygnd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtaGlkZGVuJykpIHtcblx0XHRcdFx0XHQkKCcjd29vZ3JhYmV4cHJlc3MtZmllbGQtZ3JvdXAtd3JhcC0tJyArIGZpZWxkR3JvdXBJZClcblx0XHRcdFx0XHRcdC5hZGRDbGFzcygnd29vZ3JhYmV4cHJlc3MtaGlkZGVuJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJyN3b29ncmFiZXhwcmVzcy1maWVsZC1ncm91cC13cmFwLS0nICsgZmllbGRHcm91cElkKS5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdCQoJy53b29ncmFiZXhwcmVzcy1maWVsZCcpLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyICRmaWVsZCA9ICQodGhpcyk7XG5cdFx0XHR2YXIgZmllbGRVbml0ID0gJGZpZWxkLmF0dHIoJ2RhdGEtdW5pdCcpO1xuXG5cdFx0XHRpZiAoIWZpZWxkVW5pdCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdCRmaWVsZC5uZXh0KCcud29vZ3JhYmV4cHJlc3MtZmllbGQtdW5pdCcpLnJlbW92ZSgpO1xuXHRcdFx0JGZpZWxkLmFmdGVyKCc8c3BhbiBjbGFzcz1cIndvb2dyYWJleHByZXNzLWZpZWxkLXVuaXRcIj4nICsgZmllbGRVbml0ICsgJzwvc3Bhbj4nKTtcblx0XHR9KTtcblxuXHRcdHZhciBwYXJhbXMgPSBfLm1hcE9iamVjdCh3b29ncmFiZXhwcmVzc19iYWNrZW5kLCBmdW5jdGlvbiAodmFsLCBrZXkpIHtcblx0XHRcdHN3aXRjaCAoa2V5KSB7XG5cdFx0XHRcdGNhc2UgJ2RlZmF1bHRfbGF0Jzpcblx0XHRcdFx0Y2FzZSAnZGVmYXVsdF9sbmcnOlxuXHRcdFx0XHRjYXNlICd0ZXN0X2Rlc3RpbmF0aW9uX2xhdCc6XG5cdFx0XHRcdGNhc2UgJ3Rlc3RfZGVzdGluYXRpb25fbG5nJzpcblx0XHRcdFx0XHRyZXR1cm4gcGFyc2VGbG9hdCh2YWwpO1xuXG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHdvb2dyYWJleHByZXNzTWFwUGlja2VyLmluaXQocGFyYW1zKTtcblxuXHRcdHdvb2dyYWJleHByZXNzVG9nZ2xlQnV0dG9ucygpO1xuXHR9LFxuXHRtYXliZU9wZW5Nb2RhbDogZnVuY3Rpb24gKCkge1xuXHRcdC8vIFRyeSBzaG93IHNldHRpbmdzIG1vZGFsIG9uIHNldHRpbmdzIHBhZ2UuXG5cdFx0aWYgKHdvb2dyYWJleHByZXNzX2JhY2tlbmQuc2hvd1NldHRpbmdzKSB7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0dmFyIGlzTWV0aG9kQWRkZWQgPSBmYWxzZTtcblx0XHRcdFx0dmFyIG1ldGhvZHMgPSAkKGRvY3VtZW50KS5maW5kKCcud2Mtc2hpcHBpbmctem9uZS1tZXRob2QtdHlwZScpO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1ldGhvZHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbWV0aG9kID0gbWV0aG9kc1tpXTtcblx0XHRcdFx0XHRpZiAoJChtZXRob2QpLnRleHQoKSA9PT0gd29vZ3JhYmV4cHJlc3NfYmFja2VuZC5tZXRob2RUaXRsZSkge1xuXHRcdFx0XHRcdFx0JChtZXRob2QpLmNsb3Nlc3QoJ3RyJykuZmluZCgnLnJvdy1hY3Rpb25zIC53Yy1zaGlwcGluZy16b25lLW1ldGhvZC1zZXR0aW5ncycpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdFx0XHRpc01ldGhvZEFkZGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBTaG93IEFkZCBzaGlwcGluZyBtZXRob2QgbW9kYWwgaWYgdGhlIHNoaXBwaW5nIGlzIG5vdCBhZGRlZC5cblx0XHRcdFx0aWYgKCFpc01ldGhvZEFkZGVkKSB7XG5cdFx0XHRcdFx0JCgnLndjLXNoaXBwaW5nLXpvbmUtYWRkLW1ldGhvZCcpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdFx0JCgnc2VsZWN0W25hbWU9XCJhZGRfbWV0aG9kX2lkXCJdJykudmFsKHdvb2dyYWJleHByZXNzX2JhY2tlbmQubWV0aG9kSWQpLnRyaWdnZXIoJ2NoYW5nZScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA1MDApO1xuXHRcdH1cblx0fSxcblx0c3VibWl0Rm9ybTogZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAod29vZ3JhYmV4cHJlc3NNYXBQaWNrZXIuaXNFZGl0aW5nQVBJS2V5KCkpIHtcblx0XHRcdHdpbmRvdy5hbGVydCh3b29ncmFiZXhwcmVzc0Vycm9yKCdmaW5pc2hfZWRpdGluZ19hcGknKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJyNidG4tb2snKS50cmlnZ2VyKCdjbGljaycpO1xuXHRcdH1cblx0fSxcblx0dG9nZ2xlU3RvcmVPcmlnaW5GaWVsZHM6IGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciBzZWxlY3RlZCA9ICQodGhpcykudmFsKCk7XG5cdFx0dmFyIGZpZWxkcyA9ICQodGhpcykuZGF0YSgnZmllbGRzJyk7XG5cdFx0Xy5lYWNoKGZpZWxkcywgZnVuY3Rpb24gKGZpZWxkSWRzLCBmaWVsZFZhbHVlKSB7XG5cdFx0XHRfLmVhY2goZmllbGRJZHMsIGZ1bmN0aW9uIChmaWVsZElkKSB7XG5cdFx0XHRcdGlmIChmaWVsZFZhbHVlICE9PSBzZWxlY3RlZCkge1xuXHRcdFx0XHRcdCQoJyMnICsgZmllbGRJZCkuY2xvc2VzdCgndHInKS5oaWRlKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JCgnIycgKyBmaWVsZElkKS5jbG9zZXN0KCd0cicpLnNob3coKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH0sXG5cdGluaXRGb3JtOiBmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gSW5pdCBmb3JtXG5cdFx0JChkb2N1bWVudC5ib2R5KS5vZmYoJ3djX2JhY2tib25lX21vZGFsX2xvYWRlZCcsIHdvb2dyYWJleHByZXNzQmFja2VuZC5yZW5kZXJGb3JtKTtcblx0XHQkKGRvY3VtZW50LmJvZHkpLm9uKCd3Y19iYWNrYm9uZV9tb2RhbF9sb2FkZWQnLCB3b29ncmFiZXhwcmVzc0JhY2tlbmQucmVuZGVyRm9ybSk7XG5cdH0sXG5cdGluaXQ6IGZ1bmN0aW9uICgpIHtcblx0XHR3b29ncmFiZXhwcmVzc0JhY2tlbmQuaW5pdEZvcm0oKTtcblx0XHR3b29ncmFiZXhwcmVzc0JhY2tlbmQubWF5YmVPcGVuTW9kYWwoKTtcblx0fVxufTtcblxuJChkb2N1bWVudCkucmVhZHkod29vZ3JhYmV4cHJlc3NCYWNrZW5kLmluaXQpO1xufShqUXVlcnkpKTtcbiJdfQ==
